import './polyfills.server.mjs';
import{a as me,b as si,c as ai,d as li,e as ci,f as di,i as ui,m as mi,o as pi,p as hi}from"./chunk-BYZZ33L7.mjs";import{$ as p,$a as C,Aa as W,Bb as ri,Da as v,Ea as Yt,Fa as f,Ga as ue,Gb as k,H as ie,Ha as Zt,Hb as j,I as we,Ia as a,Ib as oi,J as G,Ja as s,Jb as De,K as B,Ka as V,Kb as I,L as Me,La as Xt,Ma as Kt,N as ye,Na as w,Oa as g,P as le,Pa as m,Q as vt,Qa as T,Ra as Ve,Sa as bt,T as O,Ta as yt,U as Te,Ua as Ct,V as P,Va as l,W as Bt,Wa as b,Xa as M,Ya as Re,Za as St,_ as ce,_a as ei,aa as h,ab as S,ba as de,bb as x,cb as H,db as F,ea as Ee,eb as R,f as $,fb as L,ga as N,i as Lt,jb as ti,la as qt,n as Ut,ob as ii,ra as d,rb as ne,s as Wt,sa as _,ta as $t,ua as Gt,va as Ht,wa as Ne,wb as xt,xa as zt,xb as ni,ya as Qt,yb as wt}from"./chunk-YJ37JJ2D.mjs";import{a as D,b as X}from"./chunk-NDYDZJSS.mjs";var gi=(()=>{let i=class i{constructor(){this.title="client"}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=O({type:i,selectors:[["app-root"]],standalone:!0,features:[F],decls:1,vars:0,template:function(t,r){t&1&&V(0,"router-outlet")},dependencies:[mi],encapsulation:2});let o=i;return o})();var Ti=(()=>{let i=class i{constructor(e,t){this._renderer=e,this._elementRef=t,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}};i.\u0275fac=function(t){return new(t||i)(_(Ne),_(Ee))},i.\u0275dir=P({type:i});let o=i;return o})(),je=(()=>{let i=class i extends Ti{};i.\u0275fac=(()=>{let e;return function(r){return(e||(e=de(i)))(r||i)}})(),i.\u0275dir=P({type:i,features:[W]});let o=i;return o})(),he=new ye(""),an={provide:he,useExisting:G(()=>Ot),multi:!0},Ot=(()=>{let i=class i extends je{writeValue(e){this.setProperty("checked",e)}};i.\u0275fac=(()=>{let e;return function(r){return(e||(e=de(i)))(r||i)}})(),i.\u0275dir=P({type:i,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,r){t&1&&g("change",function(u){return r.onChange(u.target.checked)})("blur",function(){return r.onTouched()})},features:[H([an]),W]});let o=i;return o})(),ln={provide:he,useExisting:G(()=>q),multi:!0};function cn(){let o=wt()?wt().getUserAgent():"";return/android (\d+)/.test(o.toLowerCase())}var dn=new ye(""),q=(()=>{let i=class i extends Ti{constructor(e,t,r){super(e,t),this._compositionMode=r,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!cn())}writeValue(e){let t=e??"";this.setProperty("value",t)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}};i.\u0275fac=function(t){return new(t||i)(_(Ne),_(Ee),_(dn,8))},i.\u0275dir=P({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){t&1&&g("input",function(u){return r._handleInput(u.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(u){return r._compositionEnd(u.target.value)})},features:[H([ln]),W]});let o=i;return o})();function un(o){return o==null||(typeof o=="string"||Array.isArray(o))&&o.length===0}var Ge=new ye(""),ot=new ye("");function mn(o){return un(o.value)?{required:!0}:null}function fi(o){return null}function Ei(o){return o!=null}function Vi(o){return ti(o)?Lt(o):o}function Di(o){let i={};return o.forEach(n=>{i=n!=null?D(D({},i),n):i}),Object.keys(i).length===0?null:i}function Oi(o,i){return i.map(n=>n(o))}function pn(o){return!o.validate}function Fi(o){return o.map(i=>pn(i)?i:n=>i.validate(n))}function hn(o){if(!o)return null;let i=o.filter(Ei);return i.length==0?null:function(n){return Di(Oi(n,i))}}function Ft(o){return o!=null?hn(Fi(o)):null}function gn(o){if(!o)return null;let i=o.filter(Ei);return i.length==0?null:function(n){let e=Oi(n,i).map(Vi);return Wt(e).pipe(Ut(Di))}}function It(o){return o!=null?gn(Fi(o)):null}function _i(o,i){return o===null?[i]:Array.isArray(o)?[...o,i]:[o,i]}function Ii(o){return o._rawValidators}function Pi(o){return o._rawAsyncValidators}function Mt(o){return o?Array.isArray(o)?o:[o]:[]}function Xe(o,i){return Array.isArray(o)?o.includes(i):o===i}function vi(o,i){let n=Mt(i);return Mt(o).forEach(t=>{Xe(n,t)||n.push(t)}),n}function bi(o,i){return Mt(i).filter(n=>!Xe(o,n))}var Ke=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(i){this._rawValidators=i||[],this._composedValidatorFn=Ft(this._rawValidators)}_setAsyncValidators(i){this._rawAsyncValidators=i||[],this._composedAsyncValidatorFn=It(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(i){this._onDestroyCallbacks.push(i)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(i=>i()),this._onDestroyCallbacks=[]}reset(i=void 0){this.control&&this.control.reset(i)}hasError(i,n){return this.control?this.control.hasError(i,n):!1}getError(i,n){return this.control?this.control.getError(i,n):null}},re=class extends Ke{get formDirective(){return null}get path(){return null}},Ce=class extends Ke{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},et=class{constructor(i){this._cd=i}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},fn={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},xo=X(D({},fn),{"[class.ng-submitted]":"isSubmitted"}),z=(()=>{let i=class i extends et{constructor(e){super(e)}};i.\u0275fac=function(t){return new(t||i)(_(Ce,2))},i.\u0275dir=P({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){t&2&&ue("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[W]});let o=i;return o})(),Q=(()=>{let i=class i extends et{constructor(e){super(e)}};i.\u0275fac=function(t){return new(t||i)(_(re,10))},i.\u0275dir=P({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,r){t&2&&ue("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[W]});let o=i;return o})();var Le="VALID",Ze="INVALID",Oe="PENDING",Ue="DISABLED",pe=class{},tt=class extends pe{constructor(i,n){super(),this.value=i,this.source=n}},Be=class extends pe{constructor(i,n){super(),this.pristine=i,this.source=n}},qe=class extends pe{constructor(i,n){super(),this.touched=i,this.source=n}},Fe=class extends pe{constructor(i,n){super(),this.status=i,this.source=n}},Tt=class extends pe{constructor(i){super(),this.source=i}},Et=class extends pe{constructor(i){super(),this.source=i}};function Pt(o){return(st(o)?o.validators:o)||null}function _n(o){return Array.isArray(o)?Ft(o):o||null}function jt(o,i){return(st(i)?i.asyncValidators:o)||null}function vn(o){return Array.isArray(o)?It(o):o||null}function st(o){return o!=null&&!Array.isArray(o)&&typeof o=="object"}function ji(o,i,n){let e=o.controls;if(!(i?Object.keys(e):e).length)throw new we(1e3,"");if(!e[n])throw new we(1001,"")}function Ai(o,i,n){o._forEachChild((e,t)=>{if(n[t]===void 0)throw new we(1002,"")})}var Ie=class{constructor(i,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._events=new $,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(i),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(i){this._rawValidators=this._composedValidatorFn=i}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(i){this._rawAsyncValidators=this._composedAsyncValidatorFn=i}get parent(){return this._parent}get valid(){return this.status===Le}get invalid(){return this.status===Ze}get pending(){return this.status==Oe}get disabled(){return this.status===Ue}get enabled(){return this.status!==Ue}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(i){this._assignValidators(i)}setAsyncValidators(i){this._assignAsyncValidators(i)}addValidators(i){this.setValidators(vi(i,this._rawValidators))}addAsyncValidators(i){this.setAsyncValidators(vi(i,this._rawAsyncValidators))}removeValidators(i){this.setValidators(bi(i,this._rawValidators))}removeAsyncValidators(i){this.setAsyncValidators(bi(i,this._rawAsyncValidators))}hasValidator(i){return Xe(this._rawValidators,i)}hasAsyncValidator(i){return Xe(this._rawAsyncValidators,i)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(i={}){let n=this.touched===!1;this.touched=!0;let e=i.sourceControl??this;this._parent&&!i.onlySelf&&this._parent.markAsTouched(X(D({},i),{sourceControl:e})),n&&i.emitEvent!==!1&&this._events.next(new qe(!0,e))}markAllAsTouched(i={}){this.markAsTouched({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsTouched(i))}markAsUntouched(i={}){let n=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let e=i.sourceControl??this;this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:e})}),this._parent&&!i.onlySelf&&this._parent._updateTouched(i,e),n&&i.emitEvent!==!1&&this._events.next(new qe(!1,e))}markAsDirty(i={}){let n=this.pristine===!0;this.pristine=!1;let e=i.sourceControl??this;this._parent&&!i.onlySelf&&this._parent.markAsDirty(X(D({},i),{sourceControl:e})),n&&i.emitEvent!==!1&&this._events.next(new Be(!1,e))}markAsPristine(i={}){let n=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let e=i.sourceControl??this;this._forEachChild(t=>{t.markAsPristine({onlySelf:!0,emitEvent:i.emitEvent})}),this._parent&&!i.onlySelf&&this._parent._updatePristine(i,e),n&&i.emitEvent!==!1&&this._events.next(new Be(!0,e))}markAsPending(i={}){this.status=Oe;let n=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new Fe(this.status,n)),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.markAsPending(X(D({},i),{sourceControl:n}))}disable(i={}){let n=this._parentMarkedDirty(i.onlySelf);this.status=Ue,this.errors=null,this._forEachChild(t=>{t.disable(X(D({},i),{onlySelf:!0}))}),this._updateValue();let e=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new tt(this.value,e)),this._events.next(new Fe(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(X(D({},i),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(t=>t(!0))}enable(i={}){let n=this._parentMarkedDirty(i.onlySelf);this.status=Le,this._forEachChild(e=>{e.enable(X(D({},i),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent}),this._updateAncestors(X(D({},i),{skipPristineCheck:n}),this),this._onDisabledChange.forEach(e=>e(!1))}_updateAncestors(i,n){this._parent&&!i.onlySelf&&(this._parent.updateValueAndValidity(i),i.skipPristineCheck||this._parent._updatePristine({},n),this._parent._updateTouched({},n))}setParent(i){this._parent=i}getRawValue(){return this.value}updateValueAndValidity(i={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let e=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Le||this.status===Oe)&&this._runAsyncValidator(e,i.emitEvent)}let n=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new tt(this.value,n)),this._events.next(new Fe(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.updateValueAndValidity(X(D({},i),{sourceControl:n}))}_updateTreeValidity(i={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(i)),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ue:Le}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(i,n){if(this.asyncValidator){this.status=Oe,this._hasOwnPendingAsyncValidator={emitEvent:n!==!1};let e=Vi(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(t=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(t,{emitEvent:n,shouldHaveEmitted:i})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let i=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,i}return!1}setErrors(i,n={}){this.errors=i,this._updateControlsErrors(n.emitEvent!==!1,this,n.shouldHaveEmitted)}get(i){let n=i;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((e,t)=>e&&e._find(t),this)}getError(i,n){let e=n?this.get(n):this;return e&&e.errors?e.errors[i]:null}hasError(i,n){return!!this.getError(i,n)}get root(){let i=this;for(;i._parent;)i=i._parent;return i}_updateControlsErrors(i,n,e){this.status=this._calculateStatus(),i&&this.statusChanges.emit(this.status),(i||e)&&this._events.next(new Fe(this.status,n)),this._parent&&this._parent._updateControlsErrors(i,n,e)}_initObservables(){this.valueChanges=new N,this.statusChanges=new N}_calculateStatus(){return this._allControlsDisabled()?Ue:this.errors?Ze:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Oe)?Oe:this._anyControlsHaveStatus(Ze)?Ze:Le}_anyControlsHaveStatus(i){return this._anyControls(n=>n.status===i)}_anyControlsDirty(){return this._anyControls(i=>i.dirty)}_anyControlsTouched(){return this._anyControls(i=>i.touched)}_updatePristine(i,n){let e=!this._anyControlsDirty(),t=this.pristine!==e;this.pristine=e,this._parent&&!i.onlySelf&&this._parent._updatePristine(i,n),t&&this._events.next(new Be(this.pristine,n))}_updateTouched(i={},n){this.touched=this._anyControlsTouched(),this._events.next(new qe(this.touched,n)),this._parent&&!i.onlySelf&&this._parent._updateTouched(i,n)}_registerOnCollectionChange(i){this._onCollectionChange=i}_setUpdateStrategy(i){st(i)&&i.updateOn!=null&&(this._updateOn=i.updateOn)}_parentMarkedDirty(i){let n=this._parent&&this._parent.dirty;return!i&&!!n&&!this._parent._anyControlsDirty()}_find(i){return null}_assignValidators(i){this._rawValidators=Array.isArray(i)?i.slice():i,this._composedValidatorFn=_n(this._rawValidators)}_assignAsyncValidators(i){this._rawAsyncValidators=Array.isArray(i)?i.slice():i,this._composedAsyncValidatorFn=vn(this._rawAsyncValidators)}},Pe=class extends Ie{constructor(i,n,e){super(Pt(n),jt(e,n)),this.controls=i,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(i,n){return this.controls[i]?this.controls[i]:(this.controls[i]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(i,n,e={}){this.registerControl(i,n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}removeControl(i,n={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(i,n,e={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],n&&this.registerControl(i,n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}contains(i){return this.controls.hasOwnProperty(i)&&this.controls[i].enabled}setValue(i,n={}){Ai(this,!0,i),Object.keys(i).forEach(e=>{ji(this,!0,e),this.controls[e].setValue(i[e],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(i,n={}){i!=null&&(Object.keys(i).forEach(e=>{let t=this.controls[e];t&&t.patchValue(i[e],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(i={},n={}){this._forEachChild((e,t)=>{e.reset(i?i[t]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n,this),this._updateTouched(n,this),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(i,n,e)=>(i[e]=n.getRawValue(),i))}_syncPendingControls(){let i=this._reduceChildren(!1,(n,e)=>e._syncPendingControls()?!0:n);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){Object.keys(this.controls).forEach(n=>{let e=this.controls[n];e&&i(e,n)})}_setUpControls(){this._forEachChild(i=>{i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(i){for(let[n,e]of Object.entries(this.controls))if(this.contains(n)&&i(e))return!0;return!1}_reduceValue(){let i={};return this._reduceChildren(i,(n,e,t)=>((e.enabled||this.disabled)&&(n[t]=e.value),n))}_reduceChildren(i,n){let e=i;return this._forEachChild((t,r)=>{e=n(e,t,r)}),e}_allControlsDisabled(){for(let i of Object.keys(this.controls))if(this.controls[i].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(i){return this.controls.hasOwnProperty(i)?this.controls[i]:null}};var Vt=class extends Pe{};var He=new ye("CallSetDisabledState",{providedIn:"root",factory:()=>at}),at="always";function ki(o,i){return[...i.path,o]}function it(o,i,n=at){At(o,i),i.valueAccessor.writeValue(o.value),(o.disabled||n==="always")&&i.valueAccessor.setDisabledState?.(o.disabled),yn(o,i),Sn(o,i),Cn(o,i),bn(o,i)}function yi(o,i,n=!0){let e=()=>{};i.valueAccessor&&(i.valueAccessor.registerOnChange(e),i.valueAccessor.registerOnTouched(e)),rt(o,i),o&&(i._invokeOnDestroyCallbacks(),o._registerOnCollectionChange(()=>{}))}function nt(o,i){o.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(i)})}function bn(o,i){if(i.valueAccessor.setDisabledState){let n=e=>{i.valueAccessor.setDisabledState(e)};o.registerOnDisabledChange(n),i._registerOnDestroy(()=>{o._unregisterOnDisabledChange(n)})}}function At(o,i){let n=Ii(o);i.validator!==null?o.setValidators(_i(n,i.validator)):typeof n=="function"&&o.setValidators([n]);let e=Pi(o);i.asyncValidator!==null?o.setAsyncValidators(_i(e,i.asyncValidator)):typeof e=="function"&&o.setAsyncValidators([e]);let t=()=>o.updateValueAndValidity();nt(i._rawValidators,t),nt(i._rawAsyncValidators,t)}function rt(o,i){let n=!1;if(o!==null){if(i.validator!==null){let t=Ii(o);if(Array.isArray(t)&&t.length>0){let r=t.filter(c=>c!==i.validator);r.length!==t.length&&(n=!0,o.setValidators(r))}}if(i.asyncValidator!==null){let t=Pi(o);if(Array.isArray(t)&&t.length>0){let r=t.filter(c=>c!==i.asyncValidator);r.length!==t.length&&(n=!0,o.setAsyncValidators(r))}}}let e=()=>{};return nt(i._rawValidators,e),nt(i._rawAsyncValidators,e),n}function yn(o,i){i.valueAccessor.registerOnChange(n=>{o._pendingValue=n,o._pendingChange=!0,o._pendingDirty=!0,o.updateOn==="change"&&Ji(o,i)})}function Cn(o,i){i.valueAccessor.registerOnTouched(()=>{o._pendingTouched=!0,o.updateOn==="blur"&&o._pendingChange&&Ji(o,i),o.updateOn!=="submit"&&o.markAsTouched()})}function Ji(o,i){o._pendingDirty&&o.markAsDirty(),o.setValue(o._pendingValue,{emitModelToViewChange:!1}),i.viewToModelUpdate(o._pendingValue),o._pendingChange=!1}function Sn(o,i){let n=(e,t)=>{i.valueAccessor.writeValue(e),t&&i.viewToModelUpdate(e)};o.registerOnChange(n),i._registerOnDestroy(()=>{o._unregisterOnChange(n)})}function Ni(o,i){o==null,At(o,i)}function xn(o,i){return rt(o,i)}function Ri(o,i){if(!o.hasOwnProperty("model"))return!1;let n=o.model;return n.isFirstChange()?!0:!Object.is(i,n.currentValue)}function wn(o){return Object.getPrototypeOf(o.constructor)===je}function Li(o,i){o._syncPendingControls(),i.forEach(n=>{let e=n.control;e.updateOn==="submit"&&e._pendingChange&&(n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)})}function Ui(o,i){if(!i)return null;Array.isArray(i);let n,e,t;return i.forEach(r=>{r.constructor===q?n=r:wn(r)?e=r:t=r}),t||e||n||null}function Mn(o,i){let n=o.indexOf(i);n>-1&&o.splice(n,1)}var Tn={provide:re,useExisting:G(()=>oe)},We=Promise.resolve(),oe=(()=>{let i=class i extends re{constructor(e,t,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new N,this.form=new Pe({},Ft(e),It(t))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){We.then(()=>{let t=this._findContainer(e.path);e.control=t.registerControl(e.name,e.control),it(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){We.then(()=>{let t=this._findContainer(e.path);t&&t.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){We.then(()=>{let t=this._findContainer(e.path),r=new Pe({});Ni(r,e),t.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){We.then(()=>{let t=this._findContainer(e.path);t&&t.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,t){We.then(()=>{this.form.get(e.path).setValue(t)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,Li(this.form,this._directives),this.ngSubmit.emit(e),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}};i.\u0275fac=function(t){return new(t||i)(_(Ge,10),_(ot,10),_(He,8))},i.\u0275dir=P({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,r){t&1&&g("submit",function(u){return r.onSubmit(u)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[H([Tn]),W]});let o=i;return o})();function Ci(o,i){let n=o.indexOf(i);n>-1&&o.splice(n,1)}function Si(o){return typeof o=="object"&&o!==null&&Object.keys(o).length===2&&"value"in o&&"disabled"in o}var $e=class extends Ie{constructor(i=null,n,e){super(Pt(n),jt(e,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(i),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),st(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Si(i)?this.defaultValue=i.value:this.defaultValue=i)}setValue(i,n={}){this.value=this._pendingValue=i,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(e=>e(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(i,n={}){this.setValue(i,n)}reset(i=this.defaultValue,n={}){this._applyFormState(i),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(i){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(i){this._onChange.push(i)}_unregisterOnChange(i){Ci(this._onChange,i)}registerOnDisabledChange(i){this._onDisabledChange.push(i)}_unregisterOnDisabledChange(i){Ci(this._onDisabledChange,i)}_forEachChild(i){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(i){Si(i)?(this.value=this._pendingValue=i.value,i.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=i}};var En=o=>o instanceof $e;var Vn={provide:Ce,useExisting:G(()=>se)},xi=Promise.resolve(),se=(()=>{let i=class i extends Ce{constructor(e,t,r,c,u,y){super(),this._changeDetectorRef=u,this.callSetDisabledState=y,this.control=new $e,this._registered=!1,this.name="",this.update=new N,this._parent=e,this._setValidators(t),this._setAsyncValidators(r),this.valueAccessor=Ui(this,c)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let t=e.name.previousValue;this.formDirective.removeControl({name:t,path:this._getPath(t)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),Ri(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){it(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){xi.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let t=e.isDisabled.currentValue,r=t!==0&&xt(t);xi.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?ki(e,this._parent):[e]}};i.\u0275fac=function(t){return new(t||i)(_(re,9),_(Ge,10),_(ot,10),_(he,10),_(ne,8),_(He,8))},i.\u0275dir=P({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[H([Vn]),W,ce]});let o=i;return o})(),Y=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=P({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let o=i;return o})(),Dn={provide:he,useExisting:G(()=>Se),multi:!0},Se=(()=>{let i=class i extends je{writeValue(e){let t=e??"";this.setProperty("value",t)}registerOnChange(e){this.onChange=t=>{e(t==""?null:parseFloat(t))}}};i.\u0275fac=(()=>{let e;return function(r){return(e||(e=de(i)))(r||i)}})(),i.\u0275dir=P({type:i,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,r){t&1&&g("input",function(u){return r.onChange(u.target.value)})("blur",function(){return r.onTouched()})},features:[H([Dn]),W]});let o=i;return o})();var On={provide:he,useExisting:G(()=>kt),multi:!0},kt=(()=>{let i=class i extends je{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=t=>{e(t==""?null:parseFloat(t))}}};i.\u0275fac=(()=>{let e;return function(r){return(e||(e=de(i)))(r||i)}})(),i.\u0275dir=P({type:i,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,r){t&1&&g("change",function(u){return r.onChange(u.target.value)})("input",function(u){return r.onChange(u.target.value)})("blur",function(){return r.onTouched()})},features:[H([On]),W]});let o=i;return o})(),Wi=new ye("");var Fn={provide:re,useExisting:G(()=>ze)},ze=(()=>{let i=class i extends re{constructor(e,t,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new N,this._setValidators(e),this._setAsyncValidators(t)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(rt(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let t=this.form.get(e.path);return it(t,e,this.callSetDisabledState),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}getControl(e){return this.form.get(e.path)}removeControl(e){yi(e.control||null,e,!1),Mn(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,t){this.form.get(e.path).setValue(t)}onSubmit(e){return this.submitted=!0,Li(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new Tt(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1,this.form._events.next(new Et(this.form))}_updateDomValue(){this.directives.forEach(e=>{let t=e.control,r=this.form.get(e.path);t!==r&&(yi(t||null,e),En(r)&&(it(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let t=this.form.get(e.path);Ni(t,e),t.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let t=this.form.get(e.path);t&&xn(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){At(this.form,this),this._oldForm&&rt(this._oldForm,this)}_checkFormPresent(){this.form}};i.\u0275fac=function(t){return new(t||i)(_(Ge,10),_(ot,10),_(He,8))},i.\u0275dir=P({type:i,selectors:[["","formGroup",""]],hostBindings:function(t,r){t&1&&g("submit",function(u){return r.onSubmit(u)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[H([Fn]),W,ce]});let o=i;return o})();var In={provide:Ce,useExisting:G(()=>Qe)},Qe=(()=>{let i=class i extends Ce{set isDisabled(e){}constructor(e,t,r,c,u){super(),this._ngModelWarningConfig=u,this._added=!1,this.name=null,this.update=new N,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(t),this._setAsyncValidators(r),this.valueAccessor=Ui(this,c)}ngOnChanges(e){this._added||this._setUpControl(),Ri(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return ki(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};i._ngModelWarningSentOnce=!1,i.\u0275fac=function(t){return new(t||i)(_(re,13),_(Ge,10),_(ot,10),_(he,10),_(Wi,8))},i.\u0275dir=P({type:i,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[H([In]),W,ce]});let o=i;return o})(),Pn={provide:he,useExisting:G(()=>ee),multi:!0};function Bi(o,i){return o==null?`${i}`:(i&&typeof i=="object"&&(i="Object"),`${o}: ${i}`.slice(0,50))}function jn(o){return o.split(":")[0]}var ee=(()=>{let i=class i extends je{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;let t=this._getOptionId(e),r=Bi(t,e);this.setProperty("value",r)}registerOnChange(e){this.onChange=t=>{this.value=this._getOptionValue(t),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(let t of this._optionMap.keys())if(this._compareWith(this._optionMap.get(t),e))return t;return null}_getOptionValue(e){let t=jn(e);return this._optionMap.has(t)?this._optionMap.get(t):e}};i.\u0275fac=(()=>{let e;return function(r){return(e||(e=de(i)))(r||i)}})(),i.\u0275dir=P({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,r){t&1&&g("change",function(u){return r.onChange(u.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[H([Pn]),W]});let o=i;return o})(),ge=(()=>{let i=class i{constructor(e,t,r){this._element=e,this._renderer=t,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){this._select!=null&&(this._select._optionMap.set(this.id,e),this._setElementValue(Bi(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};i.\u0275fac=function(t){return new(t||i)(_(Ee),_(Ne),_(ee,9))},i.\u0275dir=P({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let o=i;return o})(),An={provide:he,useExisting:G(()=>qi),multi:!0};function wi(o,i){return o==null?`${i}`:(typeof i=="string"&&(i=`'${i}'`),i&&typeof i=="object"&&(i="Object"),`${o}: ${i}`.slice(0,50))}function kn(o){return o.split(":")[0]}var qi=(()=>{let i=class i extends je{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;let t;if(Array.isArray(e)){let r=e.map(c=>this._getOptionId(c));t=(c,u)=>{c._setSelected(r.indexOf(u.toString())>-1)}}else t=(r,c)=>{r._setSelected(!1)};this._optionMap.forEach(t)}registerOnChange(e){this.onChange=t=>{let r=[],c=t.selectedOptions;if(c!==void 0){let u=c;for(let y=0;y<u.length;y++){let E=u[y],A=this._getOptionValue(E.value);r.push(A)}}else{let u=t.options;for(let y=0;y<u.length;y++){let E=u[y];if(E.selected){let A=this._getOptionValue(E.value);r.push(A)}}}this.value=r,e(r)}}_registerOption(e){let t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}_getOptionId(e){for(let t of this._optionMap.keys())if(this._compareWith(this._optionMap.get(t)._value,e))return t;return null}_getOptionValue(e){let t=kn(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}};i.\u0275fac=(()=>{let e;return function(r){return(e||(e=de(i)))(r||i)}})(),i.\u0275dir=P({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,r){t&1&&g("change",function(u){return r.onChange(u.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[H([An]),W]});let o=i;return o})(),fe=(()=>{let i=class i{constructor(e,t,r){this._element=e,this._renderer=t,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){this._select!=null&&(this._value=e,this._setElementValue(wi(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(wi(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};i.\u0275fac=function(t){return new(t||i)(_(Ee),_(Ne),_(qi,9))},i.\u0275dir=P({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let o=i;return o})();var Jn=(()=>{let i=class i{constructor(){this._validator=fi}ngOnChanges(e){if(this.inputName in e){let t=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(t),this._validator=this._enabled?this.createValidator(t):fi,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return e!=null}};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=P({type:i,features:[ce]});let o=i;return o})();var Nn={provide:Ge,useExisting:G(()=>K),multi:!0};var K=(()=>{let i=class i extends Jn{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=xt,this.createValidator=e=>mn}enabled(e){return e}};i.\u0275fac=(()=>{let e;return function(r){return(e||(e=de(i)))(r||i)}})(),i.\u0275dir=P({type:i,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(t,r){t&2&&Yt("required",r._enabled?"":null)},inputs:{required:"required"},features:[H([Nn]),W]});let o=i;return o})();var $i=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=Te({type:i}),i.\u0275inj=Me({});let o=i;return o})(),Dt=class extends Ie{constructor(i,n,e){super(Pt(n),jt(e,n)),this.controls=i,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(i){return this.controls[this._adjustIndex(i)]}push(i,n={}){this.controls.push(i),this._registerControl(i),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(i,n,e={}){this.controls.splice(i,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:e.emitEvent})}removeAt(i,n={}){let e=this._adjustIndex(i);e<0&&(e=0),this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(i,n,e={}){let t=this._adjustIndex(i);t<0&&(t=0),this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),n&&(this.controls.splice(t,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(i,n={}){Ai(this,!1,i),i.forEach((e,t)=>{ji(this,!1,t),this.at(t).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(i,n={}){i!=null&&(i.forEach((e,t)=>{this.at(t)&&this.at(t).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(i=[],n={}){this._forEachChild((e,t)=>{e.reset(i[t],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n,this),this._updateTouched(n,this),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(i=>i.getRawValue())}clear(i={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:i.emitEvent}))}_adjustIndex(i){return i<0?i+this.length:i}_syncPendingControls(){let i=this.controls.reduce((n,e)=>e._syncPendingControls()?!0:n,!1);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){this.controls.forEach((n,e)=>{i(n,e)})}_updateValue(){this.value=this.controls.filter(i=>i.enabled||this.disabled).map(i=>i.value)}_anyControls(i){return this.controls.some(n=>n.enabled&&i(n))}_setUpControls(){this._forEachChild(i=>this._registerControl(i))}_allControlsDisabled(){for(let i of this.controls)if(i.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(i){i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)}_find(i){return this.at(i)??null}};function Mi(o){return!!o&&(o.asyncValidators!==void 0||o.validators!==void 0||o.updateOn!==void 0)}var lt=(()=>{let i=class i{constructor(){this.useNonNullable=!1}get nonNullable(){let e=new i;return e.useNonNullable=!0,e}group(e,t=null){let r=this._reduceControls(e),c={};return Mi(t)?c=t:t!==null&&(c.validators=t.validator,c.asyncValidators=t.asyncValidator),new Pe(r,c)}record(e,t=null){let r=this._reduceControls(e);return new Vt(r,t)}control(e,t,r){let c={};return this.useNonNullable?(Mi(t)?c=t:(c.validators=t,c.asyncValidators=r),new $e(e,X(D({},c),{nonNullable:!0}))):new $e(e,t,r)}array(e,t,r){let c=e.map(u=>this._createControl(u));return new Dt(c,t,r)}_reduceControls(e){let t={};return Object.keys(e).forEach(r=>{t[r]=this._createControl(e[r])}),t}_createControl(e){if(e instanceof $e)return e;if(e instanceof Ie)return e;if(Array.isArray(e)){let t=e[0],r=e.length>1?e[1]:null,c=e.length>2?e[2]:null;return this.control(t,r,c)}else return this.control(e)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var U=(()=>{let i=class i{static withConfig(e){return{ngModule:i,providers:[{provide:He,useValue:e.callSetDisabledState??at}]}}};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=Te({type:i}),i.\u0275inj=Me({imports:[$i]});let o=i;return o})(),ct=(()=>{let i=class i{static withConfig(e){return{ngModule:i,providers:[{provide:Wi,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:He,useValue:e.callSetDisabledState??at}]}}};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=Te({type:i}),i.\u0275inj=Me({imports:[$i]});let o=i;return o})();var _e=(()=>{let i=class i{constructor(e){this.http=e,this.apiUrl="/api/clients"}getClients(){return this.http.get(this.apiUrl)}getClient(e){return this.http.get(`${this.apiUrl}/${e}`)}addClient(e){return this.http.post(this.apiUrl,e)}updateClient(e,t){return this.http.put(`${this.apiUrl}/${e}`,t)}deleteClient(e){return this.http.delete(`${this.apiUrl}/${e}`)}};i.\u0275fac=function(t){return new(t||i)(le(me))},i.\u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var Z=(()=>{let i=class i{constructor(){this.clientUpdatedSource=new $,this.serviceUpdatedSource=new $,this.jobUpdatedSource=new $,this.clientUpdated$=this.clientUpdatedSource.asObservable(),this.serviceUpdated$=this.serviceUpdatedSource.asObservable(),this.jobUpdated$=this.jobUpdatedSource.asObservable()}notifyClientUpdated(){this.clientUpdatedSource.next()}notifyServiceUpdated(){this.serviceUpdatedSource.next()}notifyJobUpdated(){this.jobUpdatedSource.next()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();function Rn(o,i){if(o&1){let n=w();a(0,"li",6)(1,"strong"),l(2),s(),a(3,"div",7)(4,"button",8),g("click",function(){let t=p(n).$implicit,r=m();return h(r.openEditClientModal(t))}),l(5,"Edit"),s(),a(6,"button",9),g("click",function(){let t=p(n).$implicit,r=m();return h(r.deleteClient(t._id))}),l(7,"Delete"),s()()()}if(o&2){let n=i.$implicit;d(2),b(n.clientname)}}function Ln(o,i){if(o&1){let n=w();a(0,"div",10)(1,"div",11)(2,"span",12),g("click",function(){p(n);let t=m();return h(t.toggleAddClientModal())}),l(3,"\xD7"),s(),a(4,"h3"),l(5,"Add Client"),s(),a(6,"form",13),g("ngSubmit",function(){p(n);let t=m();return h(t.addClient())}),a(7,"div",14)(8,"label",15),l(9,"Client Name:"),s(),a(10,"input",16),x("ngModelChange",function(t){p(n);let r=m();return S(r.newClient.clientname,t)||(r.newClient.clientname=t),h(t)}),s()(),a(11,"button",17),l(12,"Add Client"),s()()()()}if(o&2){let n=m();d(10),C("ngModel",n.newClient.clientname)}}function Un(o,i){if(o&1){let n=w();a(0,"div",10)(1,"div",11)(2,"span",12),g("click",function(){p(n);let t=m();return h(t.toggleEditClientModal())}),l(3,"\xD7"),s(),a(4,"h3"),l(5,"Edit Client"),s(),a(6,"form",13),g("ngSubmit",function(){p(n);let t=m();return h(t.updateClient())}),a(7,"div",14)(8,"label",18),l(9,"Client Name:"),s(),a(10,"input",19),x("ngModelChange",function(t){p(n);let r=m();return S(r.editingClient.clientname,t)||(r.editingClient.clientname=t),h(t)}),s()(),a(11,"button",17),l(12,"Update Client"),s()()()()}if(o&2){let n=m();d(10),C("ngModel",n.editingClient.clientname)}}var Gi=(()=>{let i=class i{constructor(e,t){this.clientService=e,this.notificationService=t,this.clients=[],this.newClient={clientname:"",jobs:[],_id:""},this.editingClient=null,this.addClientModalVisible=!1,this.editClientModalVisible=!1}ngOnInit(){this.getClients()}getClients(){this.clientService.getClients().subscribe(e=>this.clients=e)}toggleAddClientModal(){this.addClientModalVisible=!this.addClientModalVisible}toggleEditClientModal(){this.editClientModalVisible=!this.editClientModalVisible}addClient(){this.newClient.clientname.trim()&&this.clientService.addClient(this.newClient).subscribe(e=>{this.clients.push(e),this.newClient={clientname:"",jobs:[],_id:""},this.notificationService.notifyClientUpdated(),this.toggleAddClientModal()})}openEditClientModal(e){this.editingClient=D({},e),this.toggleEditClientModal()}updateClient(){this.editingClient&&this.clientService.updateClient(this.editingClient._id,this.editingClient).subscribe(()=>{let e=this.clients.findIndex(t=>t._id===this.editingClient._id);e!==-1&&(this.clients[e]=this.editingClient),this.editingClient=null,this.notificationService.notifyClientUpdated(),this.toggleEditClientModal()})}deleteClient(e){this.clientService.deleteClient(e).subscribe(()=>{this.clients=this.clients.filter(t=>t._id!==e),this.notificationService.notifyClientUpdated()})}};i.\u0275fac=function(t){return new(t||i)(_(_e),_(Z))},i.\u0275cmp=O({type:i,selectors:[["app-client"]],standalone:!0,features:[F],decls:9,vars:3,consts:[[1,"container"],[1,"text-center","my-4"],[1,"btn","btn-primary","mb-3",3,"click"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[1,"list-group-item"],[1,"btn-group"],[1,"btn","btn-outline-secondary","btn-sm","me-2",3,"click"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"modal"],[1,"modal-content"],[1,"close",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","clientname"],["type","text","name","clientname","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary","mt-3"],["for","editClientname"],["type","text","name","editClientname","required","",1,"form-control",3,"ngModelChange","ngModel"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"h2",1),l(2,"Clients"),s(),a(3,"button",2),g("click",function(){return r.toggleAddClientModal()}),l(4,"Add Client"),s(),a(5,"ul",3),v(6,Rn,8,1,"li",4),s(),v(7,Ln,13,1,"div",5)(8,Un,13,1,"div",5),s()),t&2&&(d(6),f("ngForOf",r.clients),d(),f("ngIf",r.addClientModalVisible),d(),f("ngIf",r.editClientModalVisible&&r.editingClient))},dependencies:[I,k,j,U,Y,q,z,Q,K,se,oe],styles:[".container[_ngcontent-%COMP%]{padding:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.btn[_ngcontent-%COMP%]{margin-top:10px}.list-group-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;border:1px solid #ddd;border-radius:8px;padding:15px;background-color:#f9f9f9}.list-group-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-bottom:5px}.btn-group[_ngcontent-%COMP%]{display:flex;gap:10px}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px 20px;margin:0 10px;border-radius:5px;font-size:1em;cursor:pointer;transition:background-color .3s,transform .3s}.modal[_ngcontent-%COMP%]{display:block;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#00000080}.modal-content[_ngcontent-%COMP%]{background-color:#fff;margin:10% auto;padding:20px;border:1px solid #888;width:90%;max-width:600px;border-radius:10px;box-shadow:0 4px 8px #0003}.close[_ngcontent-%COMP%]{color:#aaa;float:right;font-size:28px;font-weight:700;cursor:pointer}.close[_ngcontent-%COMP%]:hover, .close[_ngcontent-%COMP%]:focus{color:#000;text-decoration:none;cursor:pointer}.list-group[_ngcontent-%COMP%]{padding-left:0}"]});let o=i;return o})();var Je=(()=>{let i=class i{constructor(e){this.http=e,this.apiUrl="/api/services"}getServices(){return this.http.get(this.apiUrl)}getService(e){return this.http.get(`${this.apiUrl}/${e}`)}addService(e){return this.http.post(this.apiUrl,e)}updateService(e,t){return this.http.put(`${this.apiUrl}/${e}`,t)}deleteService(e){return this.http.delete(`${this.apiUrl}/${e}`)}};i.\u0275fac=function(t){return new(t||i)(le(me))},i.\u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();function Wn(o,i){if(o&1&&(a(0,"li"),l(1),R(2,"currency"),R(3,"currency"),s()),o&2){let n=i.$implicit;d(),ei(" ",n.level,": ",L(2,4,n.rate)," - Contractor Rate: ",L(3,6,n.contractorrate)," - Estimated Time: ",n.estimatedTime," min/1,000 sqft ")}}function Bn(o,i){if(o&1){let n=w();a(0,"li",6)(1,"strong"),l(2),s(),a(3,"ul"),v(4,Wn,4,8,"li",7),s(),a(5,"button",8),g("click",function(){let t=p(n).$implicit,r=m();return h(r.openEditServiceModal(t))}),l(6,"Edit"),s(),a(7,"button",9),g("click",function(){let t=p(n).$implicit,r=m();return h(r.deleteService(t._id))}),l(8,"Delete"),s()()}if(o&2){let n=i.$implicit;d(2),b(n.servicename),d(2),f("ngForOf",n.severities)}}function qn(o,i){if(o&1){let n=w();a(0,"div",14)(1,"label",20),l(2,"Severity Level:"),s(),a(3,"input",21),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.level,t)||(r.level=t),h(t)}),s(),a(4,"label",20),l(5,"Rate:"),s(),a(6,"input",22),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.rate,t)||(r.rate=t),h(t)}),s(),a(7,"label",20),l(8,"Contractor Rate:"),s(),a(9,"input",22),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.contractorrate,t)||(r.contractorrate=t),h(t)}),s(),a(10,"label",20),l(11,"Estimated Time (min/1,000 sqft):"),s(),a(12,"input",22),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.estimatedTime,t)||(r.estimatedTime=t),h(t)}),s(),a(13,"button",23),g("click",function(){let t=p(n).index,r=m(2);return h(r.removeSeverity(t))}),l(14,"Remove Severity"),s()()}if(o&2){let n=i.$implicit,e=i.index;d(),T("for","severityLevel",e,""),d(2),T("name","severityLevel",e,""),C("ngModel",n.level),d(),T("for","severityRate",e,""),d(2),T("name","severityRate",e,""),C("ngModel",n.rate),d(),T("for","severityContractorRate",e,""),d(2),T("name","severityContractorRate",e,""),C("ngModel",n.contractorrate),d(),T("for","severityEstimatedTime",e,""),d(2),T("name","severityEstimatedTime",e,""),C("ngModel",n.estimatedTime)}}function $n(o,i){if(o&1){let n=w();a(0,"div",10)(1,"div",11)(2,"span",12),g("click",function(){p(n);let t=m();return h(t.toggleAddServiceModal())}),l(3,"\xD7"),s(),a(4,"h3"),l(5,"Add Service"),s(),a(6,"form",13),g("ngSubmit",function(){p(n);let t=m();return h(t.addService())}),a(7,"div",14)(8,"label",15),l(9,"Service Name:"),s(),a(10,"input",16),x("ngModelChange",function(t){p(n);let r=m();return S(r.newService.servicename,t)||(r.newService.servicename=t),h(t)}),s()(),v(11,qn,15,20,"div",17),a(12,"button",18),g("click",function(){p(n);let t=m();return h(t.addSeverity())}),l(13,"Add Severity"),s(),a(14,"button",19),l(15,"Add Service"),s()()()()}if(o&2){let n=m();d(10),C("ngModel",n.newService.servicename),d(),f("ngForOf",n.newService.severities)}}function Gn(o,i){if(o&1){let n=w();a(0,"div",14)(1,"label",20),l(2,"Severity Level:"),s(),a(3,"input",21),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.level,t)||(r.level=t),h(t)}),s(),a(4,"label",20),l(5,"Rate:"),s(),a(6,"input",22),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.rate,t)||(r.rate=t),h(t)}),s(),a(7,"label",20),l(8,"Contractor Rate:"),s(),a(9,"input",22),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.contractorrate,t)||(r.contractorrate=t),h(t)}),s(),a(10,"label",20),l(11,"Estimated Time (min/1,000 sqft):"),s(),a(12,"input",22),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.estimatedTime,t)||(r.estimatedTime=t),h(t)}),s(),a(13,"button",23),g("click",function(){let t=p(n).index,r=m(2);return h(r.removeSeverity(t,!0))}),l(14,"Remove Severity"),s()()}if(o&2){let n=i.$implicit,e=i.index;d(),T("for","editSeverityLevel",e,""),d(2),T("name","editSeverityLevel",e,""),C("ngModel",n.level),d(),T("for","editSeverityRate",e,""),d(2),T("name","editSeverityRate",e,""),C("ngModel",n.rate),d(),T("for","editSeverityContractorRate",e,""),d(2),T("name","editSeverityContractorRate",e,""),C("ngModel",n.contractorrate),d(),T("for","editSeverityEstimatedTime",e,""),d(2),T("name","editSeverityEstimatedTime",e,""),C("ngModel",n.estimatedTime)}}function Hn(o,i){if(o&1){let n=w();a(0,"div",10)(1,"div",11)(2,"span",12),g("click",function(){p(n);let t=m();return h(t.toggleEditServiceModal())}),l(3,"\xD7"),s(),a(4,"h3"),l(5,"Edit Service"),s(),a(6,"form",13),g("ngSubmit",function(){p(n);let t=m();return h(t.updateService())}),a(7,"div",14)(8,"label",24),l(9,"Service Name:"),s(),a(10,"input",25),x("ngModelChange",function(t){p(n);let r=m();return S(r.editingService.servicename,t)||(r.editingService.servicename=t),h(t)}),s()(),v(11,Gn,15,20,"div",17),a(12,"button",18),g("click",function(){p(n);let t=m();return h(t.addSeverity(!0))}),l(13,"Add Severity"),s(),a(14,"button",19),l(15,"Update Service"),s()()()()}if(o&2){let n=m();d(10),C("ngModel",n.editingService.servicename),d(),f("ngForOf",n.editingService.severities)}}var Hi=(()=>{let i=class i{constructor(e,t){this.serviceService=e,this.notificationService=t,this.services=[],this.newService={servicename:"",severities:[{level:"",rate:0,contractorrate:0,estimatedTime:0}],_id:""},this.editingService=null,this.addServiceModalVisible=!1,this.editServiceModalVisible=!1}ngOnInit(){this.getServices()}getServices(){this.serviceService.getServices().subscribe(e=>this.services=e)}toggleAddServiceModal(){this.addServiceModalVisible=!this.addServiceModalVisible}toggleEditServiceModal(){this.editServiceModalVisible=!this.editServiceModalVisible}addSeverity(e=!1){let t={level:"",rate:0,contractorrate:0,estimatedTime:0};e&&this.editingService?this.editingService.severities.push(t):this.newService.severities.push(t)}removeSeverity(e,t=!1){t&&this.editingService?this.editingService.severities.splice(e,1):this.newService.severities.splice(e,1)}addService(){this.newService.servicename.trim()&&this.serviceService.addService(this.newService).subscribe(e=>{this.services.push(e),this.newService={servicename:"",severities:[{level:"",rate:0,contractorrate:0,estimatedTime:0}],_id:""},this.notificationService.notifyServiceUpdated(),this.toggleAddServiceModal()})}openEditServiceModal(e){this.editingService=D({},e),this.toggleEditServiceModal()}updateService(){this.editingService&&this.serviceService.updateService(this.editingService._id,this.editingService).subscribe(()=>{let e=this.services.findIndex(t=>t._id===this.editingService._id);e!==-1&&(this.services[e]=this.editingService),this.editingService=null,this.notificationService.notifyServiceUpdated(),this.toggleEditServiceModal()})}deleteService(e){this.serviceService.deleteService(e).subscribe(()=>{this.services=this.services.filter(t=>t._id!==e),this.notificationService.notifyServiceUpdated()})}};i.\u0275fac=function(t){return new(t||i)(_(Je),_(Z))},i.\u0275cmp=O({type:i,selectors:[["app-service"]],standalone:!0,features:[F],decls:9,vars:3,consts:[[1,"container"],[1,"text-center","my-4"],[1,"btn","btn-primary","mb-3",3,"click"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[1,"list-group-item"],[4,"ngFor","ngForOf"],[1,"btn","btn-outline-secondary","btn-sm","me-2",3,"click"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"modal"],[1,"modal-content"],[1,"close",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","servicename"],["type","text","name","servicename","required","",1,"form-control",3,"ngModelChange","ngModel"],["class","form-group",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","mt-3",3,"click"],["type","submit",1,"btn","btn-primary","mt-3"],[3,"for"],["type","text","required","",1,"form-control",3,"ngModelChange","ngModel","name"],["type","number","required","",1,"form-control",3,"ngModelChange","ngModel","name"],["type","button",1,"btn","btn-danger","mt-2",3,"click"],["for","editServicename"],["type","text","name","editServicename","required","",1,"form-control",3,"ngModelChange","ngModel"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"h2",1),l(2,"Services Dashboard"),s(),a(3,"button",2),g("click",function(){return r.toggleAddServiceModal()}),l(4,"Add Service"),s(),a(5,"ul",3),v(6,Bn,9,2,"li",4),s(),v(7,$n,16,2,"div",5)(8,Hn,16,2,"div",5),s()),t&2&&(d(6),f("ngForOf",r.services),d(),f("ngIf",r.addServiceModalVisible),d(),f("ngIf",r.editServiceModalVisible&&r.editingService))},dependencies:[I,k,j,De,U,Y,q,Se,z,Q,K,se,oe],styles:[".container[_ngcontent-%COMP%]{padding:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.btn[_ngcontent-%COMP%]{margin-top:10px}.list-group-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:10px;border:1px solid #ddd;border-radius:8px;padding:15px;background-color:#f9f9f9}.list-group-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-bottom:5px}.modal[_ngcontent-%COMP%]{display:block;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#00000080}.modal-content[_ngcontent-%COMP%]{background-color:#fff;margin:10% auto;padding:20px;border:1px solid #888;width:90%;max-width:600px;border-radius:10px;box-shadow:0 4px 8px #0003}.close[_ngcontent-%COMP%]{color:#aaa;float:right;font-size:28px;font-weight:700;cursor:pointer}.close[_ngcontent-%COMP%]:hover, .close[_ngcontent-%COMP%]:focus{color:#000;text-decoration:none;cursor:pointer}.list-group[_ngcontent-%COMP%]{padding-left:0}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px 20px;margin:0 10px;border-radius:5px;font-size:1em;cursor:pointer;transition:background-color .3s,transform .3s}"]});let o=i;return o})();var Uo=typeof document<"u"?document.createDocumentFragment():null;var Wo=typeof document<"u"?document.createDocumentFragment():null;var zi=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=Te({type:o}),o.\u0275inj=Me({imports:[[I]]}),o})();var ve=(()=>{let i=class i{constructor(e){this.http=e,this.jobAddedSource=new $,this.jobDeletedSource=new $,this.dateOfServiceDeletedSource=new $,this.jobAdded$=this.jobAddedSource.asObservable(),this.jobDeleted$=this.jobDeletedSource.asObservable(),this.dateOfServiceDeleted$=this.dateOfServiceDeletedSource.asObservable(),this.jobsUrl="/api/jobs"}getJobs(){return this.http.get(this.jobsUrl)}addJob(e){return this.http.post(this.jobsUrl,e).pipe(ie(t=>this.jobAddedSource.next(t)))}updateJob(e,t){let r=`${this.jobsUrl}/${e}`;return this.http.put(r,t).pipe(ie(()=>this.jobAddedSource.next(t)))}deleteJob(e){let t=`${this.jobsUrl}/${e}`;return this.http.delete(t).pipe(ie(()=>this.jobDeletedSource.next(e)))}deleteDateOfService(e,t){let r=`${this.jobsUrl}/${e}/dates/${t}`;return this.http.delete(r).pipe(ie(()=>this.dateOfServiceDeletedSource.next({jobId:e,dateId:t})))}claimJob(e,t){let r=`${this.jobsUrl}/${e}/claim`;return this.http.put(r,{contractorId:t}).pipe(ie(c=>{this.jobAddedSource.next(c)}))}};i.\u0275fac=function(t){return new(t||i)(le(me))},i.\u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var te=(()=>{let i=class i{constructor(e){this.http=e,this.apiUrl="/api/auth",this.userRole=null,this.userServices=[],this.loginStatusSubject=new $,this.loadUserFromLocalStorage()}get loginStatus$(){return this.loginStatusSubject.asObservable()}login(e,t){return this.http.post(`${this.apiUrl}/login`,{email:e,password:t}).pipe(ie(r=>{r&&r.role&&(this.userRole=r.role,this.userServices=r.services||[],this.saveUserToLocalStorage(r),this.notifyLoginStatusChange())}))}signup(e){return this.http.post(`${this.apiUrl}/signup`,e).pipe(ie(t=>{t&&(this.userRole=t.role,this.userServices=t.services||[],this.saveUserToLocalStorage(t),this.notifyLoginStatusChange())}))}getUserRole(){return this.userRole}getCurrentUserServices(){return this.userServices}getUser(e){return this.http.get(`${this.apiUrl}/user/${e}`)}updateUser(e,t){return this.http.put(`${this.apiUrl}/user/${e}`,t)}deleteUser(e){return this.http.delete(`${this.apiUrl}/user/${e}`)}getUsersByRole(e){return this.http.get(`${this.apiUrl}/role/${e}`)}saveUserToLocalStorage(e){typeof window<"u"&&localStorage&&localStorage.setItem("currentUser",JSON.stringify(e))}loadUserFromLocalStorage(){if(typeof window<"u"&&localStorage){let e=localStorage.getItem("currentUser");if(e){let t=JSON.parse(e);this.userRole=t.role,this.userServices=t.services||[]}}}notifyLoginStatusChange(){this.loginStatusSubject.next()}};i.\u0275fac=function(t){return new(t||i)(le(me))},i.\u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();function zn(o,i){if(o&1){let n=w();a(0,"div",9)(1,"div",10),g("click",function(){p(n);let t=m();return h(t.toggleJobType("singleDate"))}),V(2,"div",11),a(3,"div",12),l(4,"Single Date Jobs (Claimable)"),s()(),a(5,"div",10),g("click",function(){p(n);let t=m();return h(t.toggleJobType("recurring"))}),V(6,"div",13),a(7,"div",12),l(8,"Recurring Jobs"),s()(),a(9,"div",10),g("click",function(){p(n);let t=m();return h(t.toggleJobType("multiDate"))}),V(10,"div",14),a(11,"div",12),l(12,"Multi-Date Jobs"),s()()()}if(o&2){let n=m();d(2),ue("solid",n.showSingleDateJobs)("bordered",!n.showSingleDateJobs),d(4),ue("solid",n.showRecurringJobs)("bordered",!n.showRecurringJobs),d(4),ue("solid",n.showMultiDateJobs)("bordered",!n.showMultiDateJobs)}}function Qn(o,i){if(o&1&&(a(0,"div",15),l(1),s()),o&2){let n=i.$implicit;d(),b(n)}}function Yn(o,i){if(o&1&&(a(0,"span",25),l(1),s()),o&2){let n=m().$implicit;d(),Re(" Time: ",n.datesOfService[0].startTime," - ",n.datesOfService[0].endTime," ")}}function Zn(o,i){if(o&1){let n=w();a(0,"div",2),g("click",function(){let t=p(n).$implicit,r=m(3);return h(r.showModal(t))}),a(1,"span",22),l(2),s(),V(3,"br"),a(4,"span",23),l(5),s(),V(6,"br"),v(7,Yn,2,2,"span",24),s()}if(o&2){let n=i.$implicit,e=m(3);Zt(e.getEventClass(n)),d(2),b(n.jobTitle),d(3),M("Customer: ",e.getClientName(n.customer),""),d(2),f("ngIf",n.datesOfService==null?null:n.datesOfService.length)}}function Xn(o,i){if(o&1&&(a(0,"div",18)(1,"div",19),l(2),s(),a(3,"div",20),v(4,Zn,8,5,"div",21),s()()),o&2){let n=m().$implicit,e=m();d(2),b(n),d(2),f("ngForOf",e.getJobs(n))}}function Kn(o,i){if(o&1&&(a(0,"div",16),v(1,Xn,5,2,"div",17),s()),o&2){let n=i.$implicit;ue("empty",!n),d(),f("ngIf",n)}}function er(o,i){if(o&1&&(a(0,"div"),l(1),V(2,"br"),l(3),V(4,"br"),s()),o&2){let n=i.$implicit;d(),M(" Service Type: ",n.serviceType.servicename,""),d(2),M(" Severity Level: ",n.severityLevel,"")}}function tr(o,i){if(o&1&&(a(0,"div"),l(1),V(2,"br"),l(3),V(4,"br"),l(5),V(6,"br"),l(7),V(8,"br"),s()),o&2){let n=i.$implicit;d(),M(" Date of Service: ",n.date,""),d(2),M(" Start Time: ",n.startTime,""),d(2),M(" End Time: ",n.endTime,""),d(2),M(" Total Time: ",n.totalTime,"")}}function ir(o,i){if(o&1){let n=w();a(0,"div",26)(1,"div",27)(2,"span",28),g("click",function(){p(n);let t=m();return h(t.hideModal())}),l(3,"\xD7"),s(),a(4,"strong"),l(5),s(),V(6,"br"),l(7),V(8,"br"),v(9,er,5,2,"div",29)(10,tr,9,4,"div",29),s()()}if(o&2){let n=m();d(5),b(n.modalJob==null?null:n.modalJob.jobTitle),d(2),M(" Customer: ",n.modalJob!=null&&n.modalJob.customer?n.getClientName(n.modalJob==null?null:n.modalJob.customer):"Unknown",""),d(2),f("ngForOf",n.modalJob==null?null:n.modalJob.sections),d(),f("ngForOf",n.modalJob==null?null:n.modalJob.datesOfService)}}var mt=(()=>{let i=class i{constructor(e,t,r,c){this.clientService=e,this.jobService=t,this.authService=r,this.notificationService=c,this.jobs=[],this.calendarDates=[],this.weekDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.modalVisible=!1,this.modalJob=null,this.clients=[],this.userRole="",this.userServices=[],this.showSingleDateJobs=!0,this.showRecurringJobs=!0,this.showMultiDateJobs=!0,this.showClaimedJobs=!0,this.legendVisible=!0;let u=new Date;this.currentYear=u.getFullYear(),this.currentMonth=u.getMonth(),this.authService.loginStatus$.subscribe(()=>{this.loadUser(),this.filterJobs(),this.generateCalendar()}),this.notificationService.jobUpdated$.subscribe(()=>{this.reload()})}ngOnInit(){this.generateCalendar(),this.loadClients(),this.loadUser(),this.filterJobs(),this.jobService.jobAdded$.subscribe(e=>{this.jobs.push(e),this.reload()}),this.jobService.jobDeleted$.subscribe(e=>{this.jobs=this.jobs.filter(t=>t._id!==e),this.reload()}),this.jobService.dateOfServiceDeleted$.subscribe(({jobId:e,dateId:t})=>{let r=this.jobs.find(c=>c._id===e);r&&(r.datesOfService=r.datesOfService.filter(c=>c._id!==t),r.datesOfService.length===0&&(this.jobs=this.jobs.filter(c=>c._id!==e)),this.reload())})}reload(){this.generateCalendar(),this.filterJobs()}get currentMonthName(){return new Date(this.currentYear,this.currentMonth).toLocaleString("default",{month:"long"})}generateCalendar(){let e=new Date(this.currentYear,this.currentMonth,1).getDay(),t=new Date(this.currentYear,this.currentMonth+1,0).getDate();for(this.calendarDates=new Array(e).fill(null).concat(Array.from({length:t},(r,c)=>c+1));this.calendarDates.length%7!==0;)this.calendarDates.push(null)}previousMonth(){this.currentMonth===0?(this.currentMonth=11,this.currentYear--):this.currentMonth--,this.generateCalendar()}nextMonth(){this.currentMonth===11?(this.currentMonth=0,this.currentYear++):this.currentMonth++,this.generateCalendar()}getJobs(e){if(!e)return[];let t=`${this.currentYear}-${("0"+(this.currentMonth+1)).slice(-2)}-${("0"+e).slice(-2)}`;return this.jobs.filter(r=>r.datesOfService&&r.datesOfService.some(c=>c.date===t)&&(this.userRole==="manager"||this.userRole==="contractor"&&this.canViewJob(r))&&this.isJobTypeVisible(r))}isJobTypeVisible(e){let t=this.getCurrentUserId(),r=e.contractors?.includes(t)??!1;return e.datesOfService.length===1?this.showSingleDateJobs:e.isRecurring?this.showRecurringJobs:e.datesOfService.length>1&&!e.isRecurring?this.showMultiDateJobs:r?this.showClaimedJobs:!1}toggleJobType(e){switch(e){case"singleDate":this.showSingleDateJobs=!this.showSingleDateJobs;break;case"recurring":this.showRecurringJobs=!this.showRecurringJobs;break;case"multiDate":this.showMultiDateJobs=!this.showMultiDateJobs;break;case"claimed":this.showClaimedJobs=!this.showClaimedJobs;break}this.reload()}toggleLegendVisibility(){this.legendVisible=!this.legendVisible}showModal(e){this.modalJob=e,this.modalVisible=!0}hideModal(){this.modalVisible=!1,this.modalJob=null}loadClients(){this.clientService.getClients().subscribe(e=>{this.clients=e})}getClientName(e){if(!e)return"Unknown";let t=this.clients.find(r=>r._id===e);return t?t.clientname:"Unknown"}loadUser(){if(typeof window<"u"){let e=localStorage.getItem("currentUser");if(e){let t=JSON.parse(e);this.userRole=t.role,this.userServices=t.services||[]}}}filterJobs(){this.userRole==="contractor"&&(this.jobs=this.jobs.filter(e=>e.sections.some(t=>this.userServices.includes(t.serviceType._id))))}getEventClass(e){if(!e.datesOfService||e.datesOfService.length===0)return"";let t=this.getCurrentUserId(),r=e.datesOfService.length===1,c=e.contractors?.includes(t)??!1,u=(e.contractors?.length??0)>=e.numberofcontractors;return c||this.userRole==="manager"&&u?r?"event single-date-job claimed":e.isRecurring?"event contractor-claimed":"event multi-date-claimed":r?"event single-date-job claimable":e.isRecurring?"event contractor-can-claim":"event multi-date-job"}canViewJob(e){if(this.userRole!=="contractor")return!1;let t=this.getCurrentUserId(),r=e.contractors?.includes(t)??!1,c=(e.contractors?.length??0)>=e.numberofcontractors;return r||!c}getCurrentUserId(){let e=localStorage.getItem("currentUser");return e?JSON.parse(e)._id:""}};i.\u0275fac=function(t){return new(t||i)(_(_e),_(ve),_(te),_(Z))},i.\u0275cmp=O({type:i,selectors:[["app-calendar"]],inputs:{jobs:"jobs"},standalone:!0,features:[F],decls:16,vars:7,consts:[[1,"calendar-container"],[1,"calendar-header"],[3,"click"],[1,"calendar-legend-container"],["class","calendar-legend",4,"ngIf"],[1,"calendar-body"],["class","calendar-weekday",4,"ngFor","ngForOf"],["class","calendar-date",3,"empty",4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[1,"calendar-legend"],[1,"legend-item",3,"click"],[1,"legend-color","single-date"],[1,"legend-text"],[1,"legend-color","recurring"],[1,"legend-color","multi-date"],[1,"calendar-weekday"],[1,"calendar-date"],["class","date-wrapper",4,"ngIf"],[1,"date-wrapper"],[1,"date-number"],[1,"events"],[3,"class","click",4,"ngFor","ngForOf"],[1,"event-title"],[1,"event-client"],["class","event-time",4,"ngIf"],[1,"event-time"],[1,"modal"],[1,"modal-content"],[1,"close",3,"click"],[4,"ngFor","ngForOf"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"div",1)(2,"button",2),g("click",function(){return r.previousMonth()}),l(3,"\u2039"),s(),a(4,"div"),l(5),s(),a(6,"button",2),g("click",function(){return r.nextMonth()}),l(7,"\u203A"),s()(),a(8,"div",3)(9,"button",2),g("click",function(){return r.toggleLegendVisibility()}),l(10),s(),v(11,zn,13,12,"div",4),s(),a(12,"div",5),v(13,Qn,2,1,"div",6)(14,Kn,2,3,"div",7),s(),v(15,ir,11,4,"div",8),s()),t&2&&(d(5),Re("",r.currentMonthName," ",r.currentYear,""),d(5),b(r.legendVisible?"Hide Legend":"Show Legend"),d(),f("ngIf",r.legendVisible),d(2),f("ngForOf",r.weekDays),d(),f("ngForOf",r.calendarDates),d(),f("ngIf",r.modalVisible))},dependencies:[I,k,j],styles:[".calendar-container[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:auto;font-family:Arial,sans-serif;background:#fff;border-radius:10px;box-shadow:0 4px 8px #0000001a;overflow:hidden}.calendar-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background-color:#007bff;color:#fff;padding:15px}.calendar-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5em;cursor:pointer;color:#fff;transition:color .3s}.calendar-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#ccc}.calendar-legend-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:10px 15px;background-color:#f7f7f7;border-bottom:1px solid #ddd}.calendar-legend-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;transition:background-color .3s ease;margin-bottom:10px}.calendar-legend-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.calendar-legend[_ngcontent-%COMP%]{display:flex;flex-direction:column}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px;cursor:pointer}.legend-color[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:5px;margin-right:10px;transition:all .3s ease}.solid[_ngcontent-%COMP%]{background-color:currentColor}.bordered[_ngcontent-%COMP%]{border:2px solid currentColor;background-color:#fff}.legend-color.single-date[_ngcontent-%COMP%]{color:#007bff}.legend-color.recurring[_ngcontent-%COMP%]{color:#ff8c00}.legend-color.multi-date[_ngcontent-%COMP%]{color:#fdd835}.legend-text[_ngcontent-%COMP%]{font-size:.9em}.calendar-body[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);border-top:1px solid #ddd}.calendar-weekday[_ngcontent-%COMP%]{background-color:#f0f0f0;padding:15px;border-right:1px solid #ddd;text-align:center;font-weight:700}.calendar-date[_ngcontent-%COMP%]{border-bottom:1px solid #eee;border-right:1px solid #eee;min-height:100px;padding:10px;box-sizing:border-box;position:relative;transition:background-color .3s}.calendar-date.empty[_ngcontent-%COMP%]{background-color:#fafafa}.calendar-date[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.date-number[_ngcontent-%COMP%]{font-weight:700;margin-bottom:10px}.events[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.event[_ngcontent-%COMP%]{padding:5px;margin-bottom:5px;border-radius:5px;font-size:.8em;text-align:left;position:relative;cursor:pointer;transition:background-color .3s,color .3s}.event.single-date-job.claimable[_ngcontent-%COMP%]{border:2px solid #007bff;background-color:#fff;color:#000}.event.single-date-job.claimed[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.event.contractor-can-claim[_ngcontent-%COMP%]{border:2px solid #ff8c00;background-color:#fff;color:#000}.event.contractor-claimed[_ngcontent-%COMP%]{background-color:#ff8c00;color:#000}.event.multi-date-job[_ngcontent-%COMP%]{border:2px solid #fdd835;background-color:#fff;color:#000}.event.multi-date-claimed[_ngcontent-%COMP%]{background-color:#fdd835;color:#000}.event.multi-date-job[_ngcontent-%COMP%]:hover{color:#000}.event[_ngcontent-%COMP%]:hover{opacity:.9}.modal[_ngcontent-%COMP%]{display:block;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#00000080}.modal-content[_ngcontent-%COMP%]{background-color:#fff;margin:15% auto;padding:20px;border:1px solid #ccc;width:80%;max-width:600px;border-radius:10px;box-shadow:0 4px 8px #0000001a}.close[_ngcontent-%COMP%]{color:#aaa;float:right;font-size:28px;font-weight:700;cursor:pointer}.close[_ngcontent-%COMP%]:hover, .close[_ngcontent-%COMP%]:focus{color:#000;text-decoration:none;cursor:pointer}.event-title[_ngcontent-%COMP%]{font-weight:700}.event-client[_ngcontent-%COMP%], .event-time[_ngcontent-%COMP%]{font-size:.8em}.multi-date-job[_ngcontent-%COMP%]   .event-title[_ngcontent-%COMP%], .multi-date-job[_ngcontent-%COMP%]   .event-client[_ngcontent-%COMP%], .multi-date-job[_ngcontent-%COMP%]   .event-time[_ngcontent-%COMP%], .contractor-can-claim[_ngcontent-%COMP%]   .event-title[_ngcontent-%COMP%], .contractor-can-claim[_ngcontent-%COMP%]   .event-client[_ngcontent-%COMP%], .contractor-can-claim[_ngcontent-%COMP%]   .event-time[_ngcontent-%COMP%]{color:#000}"]});let o=i;return o})();function nr(o,i){if(o&1&&(a(0,"tr")(1,"th"),l(2,"Multi Date Total Price"),s(),a(3,"td"),l(4),R(5,"currency"),s()()),o&2){let n=m(2);d(4),b(L(5,1,n.job.multiDateTotalPrice))}}function rr(o,i){if(o&1&&(a(0,"tr")(1,"th"),l(2,"Date of Service"),s(),a(3,"td"),l(4),s()()),o&2){let n=i.$implicit;d(4),b(n.date)}}function or(o,i){if(o&1&&(a(0,"li"),l(1),s()),o&2){let n=i.$implicit;d(),Re("Length: ",n.length,", Width: ",n.width,"")}}function sr(o,i){if(o&1&&(Xt(0),a(1,"tr")(2,"th",9),l(3),s()(),a(4,"tr")(5,"th"),l(6,"Service Type"),s(),a(7,"td"),l(8),s()(),a(9,"tr")(10,"th"),l(11,"Severity Level"),s(),a(12,"td"),l(13),s()(),a(14,"tr")(15,"th"),l(16,"Measurements"),s(),a(17,"td")(18,"ul"),v(19,or,2,2,"li",6),s()()(),a(20,"tr")(21,"th"),l(22,"Section Time"),s(),a(23,"td"),l(24),s()(),a(25,"tr")(26,"th"),l(27,"Total Service Price"),s(),a(28,"td"),l(29),R(30,"currency"),s()(),a(31,"tr")(32,"th"),l(33,"Contractor Pay"),s(),a(34,"td"),l(35),R(36,"currency"),s()(),Kt()),o&2){let n=i.$implicit;d(3),M("Section: ",n.sectionName,""),d(5),b(n.serviceType.servicename),d(5),b(n.severityLevel),d(6),f("ngForOf",n.measurements),d(5),b(n.totalTime),d(5),b(L(30,7,n.totalprice)),d(6),b(L(36,9,n.contractorPay))}}function ar(o,i){if(o&1&&(a(0,"li"),l(1),s()),o&2){let n=i.$implicit,e=m(3);d(),b(e.getContractorName(n))}}function lr(o,i){if(o&1&&(a(0,"tr")(1,"th"),l(2,"Contractors"),s(),a(3,"td")(4,"ul"),v(5,ar,2,1,"li",6),s()()()),o&2){let n=m(2);d(5),f("ngForOf",n.job.contractors)}}function cr(o,i){if(o&1){let n=w();a(0,"div",1)(1,"div",2)(2,"span",3),g("click",function(){p(n);let t=m();return h(t.onClose())}),l(3,"\xD7"),s(),a(4,"h3"),l(5,"Job Details"),s(),a(6,"table",4)(7,"tbody")(8,"tr")(9,"th"),l(10,"Job Title"),s(),a(11,"td"),l(12),s()(),a(13,"tr")(14,"th"),l(15,"PO Number"),s(),a(16,"td"),l(17),s()(),a(18,"tr")(19,"th"),l(20,"Customer"),s(),a(21,"td"),l(22),s()(),a(23,"tr")(24,"th"),l(25,"Total Square Footage"),s(),a(26,"td"),l(27),s()(),a(28,"tr")(29,"th"),l(30,"Total Price"),s(),a(31,"td"),l(32),R(33,"currency"),s()(),v(34,nr,6,3,"tr",5),a(35,"tr")(36,"th"),l(37,"Number of Contractors"),s(),a(38,"td"),l(39),s()(),a(40,"tr")(41,"th"),l(42,"Contractor Rate"),s(),a(43,"td"),l(44),R(45,"currency"),s()(),a(46,"tr")(47,"th"),l(48,"Contractor Total Pay"),s(),a(49,"td"),l(50),R(51,"currency"),s()(),v(52,rr,5,1,"tr",6)(53,sr,37,11,"ng-container",6)(54,lr,6,1,"tr",5),s()(),a(55,"button",7),g("click",function(){p(n);let t=m();return h(t.onEdit(t.job))}),l(56,"Edit"),s(),a(57,"button",8),g("click",function(){p(n);let t=m();return h(t.onDelete(t.job._id))}),l(58,"Delete"),s()()()}if(o&2){let n=m();d(12),b(n.job.jobTitle),d(5),b(n.job.ponumber),d(5),b(n.getClientName(n.job.customer)),d(5),b(n.job.totalSquareFootage),d(5),b(L(33,12,n.job.totalprice)),d(2),f("ngIf",n.job.multiDateTotalPrice),d(5),b(n.job.numberofcontractors),d(5),b(L(45,14,n.job.contractorRate)),d(6),b(L(51,16,n.job.contractorTotalPay)),d(2),f("ngForOf",n.job.datesOfService),d(),f("ngForOf",n.job.sections),d(),f("ngIf",n.job.contractors&&n.job.contractors.length>0)}}var Qi=(()=>{let i=class i{constructor(){this.job=null,this.clients=[],this.contractors=[],this.close=new N,this.edit=new N,this.delete=new N}onClose(){this.close.emit()}onEdit(e){this.edit.emit(e)}onDelete(e){this.delete.emit(e)}getClientName(e){let t=this.clients.find(r=>r._id===e);return t?t.clientname:"Unknown"}getContractorName(e){let t=this.contractors.find(r=>r._id===e);return t?t.email:"Unknown"}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=O({type:i,selectors:[["app-job-details"]],inputs:{job:"job",clients:"clients",contractors:"contractors"},outputs:{close:"close",edit:"edit",delete:"delete"},standalone:!0,features:[F],decls:1,vars:1,consts:[["class","modal",4,"ngIf"],[1,"modal"],[1,"modal-content"],[1,"close",3,"click"],[1,"table","table-sm"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"btn","btn-danger","btn-sm","ms-2",3,"click"],["colspan","2"]],template:function(t,r){t&1&&v(0,cr,59,18,"div",0),t&2&&f("ngIf",r.job)},dependencies:[I,k,j,De,U],styles:[".modal[_ngcontent-%COMP%]{display:block;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#00000080}.modal-content[_ngcontent-%COMP%]{background-color:#fff;margin:10% auto;padding:20px;border:1px solid #888;width:90%;max-width:600px;border-radius:10px;box-shadow:0 4px 8px #0003}"]});let o=i;return o})();function dr(o,i){if(o&1&&(a(0,"option",21),l(1),s()),o&2){let n=i.$implicit;f("value",n._id),d(),b(n.clientname)}}function ur(o,i){if(o&1){let n=w();a(0,"div",4)(1,"label",22),l(2,"Recurrence Pattern:"),s(),a(3,"select",23),x("ngModelChange",function(t){p(n);let r=m();return S(r.recurrence,t)||(r.recurrence=t),h(t)}),a(4,"option",24),l(5,"Daily"),s(),a(6,"option",25),l(7,"Weekly"),s(),a(8,"option",26),l(9,"Bi-Weekly"),s(),a(10,"option",27),l(11,"Tri-Weekly"),s(),a(12,"option",28),l(13,"Monthly"),s(),a(14,"option",29),l(15,"Bi-Monthly"),s(),a(16,"option",30),l(17,"Quarterly"),s(),a(18,"option",31),l(19,"Semi-Annually"),s(),a(20,"option",32),l(21,"Annually"),s()(),a(22,"label",33),l(23,"Occurrences:"),s(),a(24,"input",34),x("ngModelChange",function(t){p(n);let r=m();return S(r.recurrenceCount,t)||(r.recurrenceCount=t),h(t)}),s()()}if(o&2){let n=m();d(3),C("ngModel",n.recurrence),d(21),C("ngModel",n.recurrenceCount)}}function mr(o,i){if(o&1){let n=w();a(0,"div",35)(1,"h5"),l(2),s(),a(3,"div",36)(4,"label",37),l(5,"Date:"),s(),a(6,"input",38),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.date,t)||(r.date=t),h(t)}),s()(),a(7,"div",36)(8,"label",39),l(9,"Start Time:"),s(),a(10,"input",40),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.startTime,t)||(r.startTime=t),h(t)}),g("change",function(){let t=p(n).$implicit,r=m();return h(r.calculateTotalTime(t))}),s()(),a(11,"div",36)(12,"label",41),l(13,"End Time:"),s(),a(14,"input",40),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.endTime,t)||(r.endTime=t),h(t)}),g("change",function(){let t=p(n).$implicit,r=m();return h(r.calculateTotalTime(t))}),s()(),a(15,"div",36)(16,"label",42),l(17,"Total Time:"),s(),a(18,"input",43),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.totalTime,t)||(r.totalTime=t),h(t)}),s()(),a(19,"button",44),g("click",function(){let t=p(n).index,r=m();return h(r.removeDateOfService(t))}),l(20,"Remove Date of Service"),s()()}if(o&2){let n=i.$implicit,e=i.index;d(2),M("Date of Service ",e+1,""),d(4),T("name","date",e,""),C("ngModel",n.date),d(4),T("name","startTime",e,""),C("ngModel",n.startTime),d(4),T("name","endTime",e,""),C("ngModel",n.endTime),d(4),T("name","totalTime",e,""),C("ngModel",n.totalTime)}}function pr(o,i){if(o&1){let n=w();a(0,"button",19),g("click",function(){p(n);let t=m();return h(t.addDateOfService())}),l(1,"Add Date of Service"),s()}}function hr(o,i){if(o&1&&(a(0,"option",21),l(1),s()),o&2){let n=i.$implicit;f("value",n._id),d(),b(n.servicename)}}function gr(o,i){if(o&1&&(a(0,"option",21),l(1),s()),o&2){let n=i.$implicit;f("value",n.level),d(),b(n.level)}}function fr(o,i){if(o&1){let n=w();a(0,"div",36)(1,"label",53),l(2,"Severity Level:"),s(),a(3,"select",49),x("ngModelChange",function(t){p(n);let r=m().$implicit;return S(r.severityLevel,t)||(r.severityLevel=t),h(t)}),g("change",function(){p(n);let t=m().index,r=m();return h(r.updateTotalPriceForSection(t))}),v(4,gr,2,2,"option",10),s()()}if(o&2){let n=m(),e=n.$implicit,t=n.index;d(3),T("name","severityLevel",t,""),C("ngModel",e.severityLevel),d(),f("ngForOf",e.severityLevels)}}function _r(o,i){if(o&1){let n=w();a(0,"div",54)(1,"h6"),l(2),s(),a(3,"div",55)(4,"div",56)(5,"label",57),l(6,"Length:"),s(),a(7,"input",58),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.length,t)||(r.length=t),h(t)}),g("input",function(){p(n);let t=m(2);return h(t.updateTotalSquareFootage())}),s()(),a(8,"div",56)(9,"label",59),l(10,"Width:"),s(),a(11,"input",58),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.width,t)||(r.width=t),h(t)}),g("input",function(){p(n);let t=m(2);return h(t.updateTotalSquareFootage())}),s()(),a(12,"div",60)(13,"button",61),g("click",function(){let t=p(n).index,r=m().index,c=m();return h(c.removeMeasurement(r,t))}),l(14,"Remove"),s()()()()}if(o&2){let n=i.$implicit,e=i.index,t=m().index;d(2),M("Measurement ",e+1,""),d(5),Ve("name","length",t,"",e,""),C("ngModel",n.length),d(4),Ve("name","width",t,"",e,""),C("ngModel",n.width)}}function vr(o,i){if(o&1){let n=w();a(0,"div",45)(1,"h5"),l(2),s(),a(3,"div",36)(4,"label",46),l(5,"Section Name:"),s(),a(6,"input",47),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.sectionName,t)||(r.sectionName=t),h(t)}),s()(),a(7,"div",36)(8,"label",48),l(9,"Service Type:"),s(),a(10,"select",49),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.serviceType._id,t)||(r.serviceType._id=t),h(t)}),g("change",function(){let t=p(n).index,r=m();return h(r.updateSeverityLevelsForSection(t))}),v(11,hr,2,2,"option",10),s()(),v(12,fr,5,4,"div",50)(13,_r,15,9,"div",51),a(14,"button",52),g("click",function(){let t=p(n).index,r=m();return h(r.addMeasurement(t))}),l(15,"Add Measurement"),s(),a(16,"button",44),g("click",function(){let t=p(n).index,r=m();return h(r.removeSection(t))}),l(17,"Remove Section"),s()()}if(o&2){let n=i.$implicit,e=i.index,t=m();d(2),M("Section ",e+1,""),d(4),T("name","sectionName",e,""),C("ngModel",n.sectionName),d(4),T("name","serviceType",e,""),C("ngModel",n.serviceType._id),d(),f("ngForOf",t.services),d(),f("ngIf",n.severityLevels.length>0),d(),f("ngForOf",n.measurements)}}var Yi=(()=>{let i=class i{constructor(e){this.cdr=e,this.job={jobTitle:"",customer:"",totalSquareFootage:0,totalprice:0,sections:[],datesOfService:[{_id:"",date:"",startTime:"",endTime:"",totalTime:""}],numberofcontractors:0,isRecurring:!1,contractorTotalPay:0,contractorRate:0,_id:""},this.clients=[],this.services=[],this.contractors=[],this.save=new N,this.close=new N,this.recurrence="",this.recurrenceCount=1}ngOnInit(){}onSubmit(){this.job.isRecurring&&this.addRecurringDates(),this.save.emit(this.job)}onClose(){this.close.emit()}addDateOfService(){this.job.datesOfService.push({_id:"",date:"",startTime:"",endTime:"",totalTime:""}),this.cdr.detectChanges()}removeDateOfService(e){this.job.datesOfService.splice(e,1),this.cdr.detectChanges()}addSection(){this.job.sections.push({jobId:"",sectionName:"",serviceType:{servicename:"",severities:[],_id:""},severityLevel:"",severityLevels:[],measurements:[],totalprice:0,contractorPay:0,totalTime:0,_id:""}),this.cdr.detectChanges()}removeSection(e){this.job.sections.splice(e,1),this.updateTotalSquareFootage(),this.cdr.detectChanges()}addMeasurement(e){this.job.sections[e].measurements.push({length:0,width:0}),this.updateTotalSquareFootage(),this.cdr.detectChanges()}removeMeasurement(e,t){this.job.sections[e].measurements.splice(t,1),this.updateTotalSquareFootage(),this.cdr.detectChanges()}updateSeverityLevelsForSection(e){let t=this.job.sections[e],r=this.services.find(c=>c._id===t.serviceType._id);r?t.severityLevels=r.severities:t.severityLevels=[],this.updateTotalPriceForSection(e),this.cdr.detectChanges()}updateTotalPriceForSection(e){let t=this.job.sections[e],r=this.services.find(u=>u._id===t.serviceType._id),c=r?.severities.find(u=>u.level===t.severityLevel);if(r&&c){let u=t.measurements.reduce((y,E)=>y+E.length*E.width,0);t.totalprice=c.rate*u,t.totalTime=this.calculateTotalTimeForSection(u,c.estimatedTime),t.contractorPay=this.calculateContractorPayForSection(t.totalTime,c.contractorrate),this.updateTotalPrice()}this.cdr.detectChanges()}updateTotalSquareFootage(){let e=0;this.job.sections.forEach(t=>{t.measurements.forEach(r=>{e+=r.length*r.width})}),this.job.totalSquareFootage=e,this.updateTotalPrice(),this.cdr.detectChanges()}updateTotalPrice(){this.job.totalprice=this.job.sections.reduce((e,t)=>e+(t.totalprice||0),0),this.job.contractorTotalPay=this.job.sections.reduce((e,t)=>e+(t.contractorPay||0),0),this.job.isRecurring&&(this.job.multiDateTotalPrice=this.recurrenceCount*this.job.totalprice),this.cdr.detectChanges()}calculateTotalTime(e){if(e.startTime&&e.endTime){let t=new Date(`1970-01-01T${e.startTime}:00`),r=new Date(`1970-01-01T${e.endTime}:00`);if(t>=r)e.totalTime="Invalid time range";else{let c=(r.getTime()-t.getTime())/1e3/60,u=Math.floor(c/60),y=c%60;e.totalTime=`${u}h ${y}m`}}this.cdr.detectChanges()}calculateTotalTimeForSection(e,t){return e/1e3*(t/60)}calculateContractorPayForSection(e,t){return e*t}onRecurrenceChange(){this.job.isRecurring||(this.recurrence="",this.recurrenceCount=1),this.cdr.detectChanges()}addRecurringDates(){let e=new Date(this.job.datesOfService[0].date),t=Math.min(this.recurrenceCount,50),r=[];for(let c=0;c<t;c++){let u=D({},this.job.datesOfService[0]);switch(this.recurrence){case"daily":u.date=this.addDays(e,c).toISOString().split("T")[0];break;case"weekly":u.date=this.addDays(e,c*7).toISOString().split("T")[0];break;case"bi-weekly":u.date=this.addDays(e,c*14).toISOString().split("T")[0];break;case"tri-weekly":u.date=this.addDays(e,c*21).toISOString().split("T")[0];break;case"monthly":u.date=this.addMonths(e,c).toISOString().split("T")[0];break;case"bi-monthly":u.date=this.addMonths(e,c*2).toISOString().split("T")[0];break;case"quarterly":u.date=this.addMonths(e,c*3).toISOString().split("T")[0];break;case"semi-annually":u.date=this.addMonths(e,c*6).toISOString().split("T")[0];break;case"annually":u.date=this.addYears(e,c).toISOString().split("T")[0];break}r.push(u)}this.job.datesOfService=r,this.job.multiDateTotalPrice=t*this.job.totalprice}addDays(e,t){let r=new Date(e);return r.setDate(r.getDate()+t),r}addMonths(e,t){let r=new Date(e);return r.setMonth(r.getMonth()+t),r}addYears(e,t){let r=new Date(e);return r.setFullYear(r.getFullYear()+t),r}};i.\u0275fac=function(t){return new(t||i)(_(ne))},i.\u0275cmp=O({type:i,selectors:[["app-job-form"]],inputs:{job:"job",clients:"clients",services:"services",contractors:"contractors"},outputs:{save:"save",close:"close"},standalone:!0,features:[F],decls:36,vars:10,consts:[[1,"modal"],[1,"modal-content"],[1,"close",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","jobTitle"],["type","text","name","jobTitle","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","ponumber","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","customer"],["name","customer","required","",1,"form-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","isRecurring"],["type","checkbox","name","isRecurring",1,"form-check-input",3,"ngModelChange","change","ngModel"],["class","form-group",4,"ngIf"],["for","numberofcontractors"],["type","number","name","numberofcontractors","required","",1,"form-control",3,"ngModelChange","ngModel"],["class","date-service-container mb-4 p-3 border rounded bg-white",4,"ngFor","ngForOf"],["type","button","class","btn btn-secondary mb-3",3,"click",4,"ngIf"],["class","section-container mb-4 p-3 border rounded bg-white",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","mb-3",3,"click"],["type","submit",1,"btn","btn-primary"],[3,"value"],["for","recurrence"],["name","recurrence","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","daily"],["value","weekly"],["value","bi-weekly"],["value","tri-weekly"],["value","monthly"],["value","bi-monthly"],["value","quarterly"],["value","semi-annually"],["value","annually"],["for","recurrenceCount"],["type","number","name","recurrenceCount","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"date-service-container","mb-4","p-3","border","rounded","bg-white"],[1,"form-group","mb-3"],["for","date"],["type","date","required","",1,"form-control",3,"ngModelChange","ngModel","name"],["for","startTime"],["type","time","required","",1,"form-control",3,"ngModelChange","change","ngModel","name"],["for","endTime"],["for","totalTime"],["type","text","readonly","",1,"form-control",3,"ngModelChange","ngModel","name"],["type","button",1,"btn","btn-danger","ms-2",3,"click"],[1,"section-container","mb-4","p-3","border","rounded","bg-white"],["for","sectionName"],["type","text","required","",1,"form-control",3,"ngModelChange","ngModel","name"],["for","serviceType"],["required","",1,"form-select",3,"ngModelChange","change","ngModel","name"],["class","form-group mb-3",4,"ngIf"],["class","measurement-container mb-2 p-2 border rounded",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary",3,"click"],["for","severityLevel"],[1,"measurement-container","mb-2","p-2","border","rounded"],[1,"row"],[1,"col"],["for","length"],["type","number","required","",1,"form-control",3,"ngModelChange","input","ngModel","name"],["for","width"],[1,"col-2","d-flex","align-items-end"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"div",1)(2,"span",2),g("click",function(){return r.onClose()}),l(3,"\xD7"),s(),a(4,"h3"),l(5,"Add Job"),s(),a(6,"form",3),g("ngSubmit",function(){return r.onSubmit()}),a(7,"div",4)(8,"label",5),l(9,"Job Title:"),s(),a(10,"input",6),x("ngModelChange",function(u){return S(r.job.jobTitle,u)||(r.job.jobTitle=u),u}),s()(),a(11,"div",4)(12,"label"),l(13,"PO Number:"),s(),a(14,"input",7),x("ngModelChange",function(u){return S(r.job.ponumber,u)||(r.job.ponumber=u),u}),s()(),a(15,"div",4)(16,"label",8),l(17,"Customer:"),s(),a(18,"select",9),x("ngModelChange",function(u){return S(r.job.customer,u)||(r.job.customer=u),u}),v(19,dr,2,2,"option",10),s()(),a(20,"div",4)(21,"label",11),l(22,"Is Recurring:"),s(),a(23,"input",12),x("ngModelChange",function(u){return S(r.job.isRecurring,u)||(r.job.isRecurring=u),u}),g("change",function(){return r.onRecurrenceChange()}),s()(),v(24,ur,25,2,"div",13),a(25,"div",4)(26,"label",14),l(27,"Number of Contractors:"),s(),a(28,"input",15),x("ngModelChange",function(u){return S(r.job.numberofcontractors,u)||(r.job.numberofcontractors=u),u}),s()(),v(29,mr,21,13,"div",16)(30,pr,2,0,"button",17)(31,vr,18,10,"div",18),a(32,"button",19),g("click",function(){return r.addSection()}),l(33,"Add Section"),s(),a(34,"button",20),l(35,"Add Job"),s()()()()),t&2&&(d(10),C("ngModel",r.job.jobTitle),d(4),C("ngModel",r.job.ponumber),d(4),C("ngModel",r.job.customer),d(),f("ngForOf",r.clients),d(4),C("ngModel",r.job.isRecurring),d(),f("ngIf",r.job.isRecurring),d(4),C("ngModel",r.job.numberofcontractors),d(),f("ngForOf",r.job.datesOfService),d(),f("ngIf",!r.job.isRecurring),d(),f("ngForOf",r.job.sections))},dependencies:[I,k,j,U,Y,ge,fe,q,Se,Ot,ee,z,Q,K,se,oe],styles:[".modal[_ngcontent-%COMP%]{display:block;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#00000080}.modal-content[_ngcontent-%COMP%]{background-color:#fff;margin:10% auto;padding:20px;border:1px solid #888;width:90%;max-width:600px;border-radius:10px;box-shadow:0 4px 8px #0003}"]});let o=i;return o})();function br(o,i){if(o&1&&(a(0,"option",14),l(1),s()),o&2){let n=i.$implicit;f("value",n._id),d(),b(n.clientname)}}function yr(o,i){if(o&1){let n=w();a(0,"div",15)(1,"h5"),l(2),s(),a(3,"div",16)(4,"label",17),l(5,"Date:"),s(),a(6,"input",18),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.date,t)||(r.date=t),h(t)}),s()(),a(7,"div",16)(8,"label",19),l(9,"Start Time:"),s(),a(10,"input",20),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.startTime,t)||(r.startTime=t),h(t)}),g("change",function(){let t=p(n).$implicit,r=m();return h(r.calculateTotalTime(t))}),s()(),a(11,"div",16)(12,"label",21),l(13,"End Time:"),s(),a(14,"input",20),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.endTime,t)||(r.endTime=t),h(t)}),g("change",function(){let t=p(n).$implicit,r=m();return h(r.calculateTotalTime(t))}),s()(),a(15,"div",16)(16,"label",22),l(17,"Total Time:"),s(),a(18,"input",23),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.totalTime,t)||(r.totalTime=t),h(t)}),s()(),a(19,"button",24),g("click",function(){let t=p(n).index,r=m();return h(r.removeDateOfService(t))}),l(20,"Remove Date of Service"),s()()}if(o&2){let n=i.$implicit,e=i.index;d(2),M("Date of Service ",e+1,""),d(4),T("name","date",e,""),C("ngModel",n.date),d(4),T("name","startTime",e,""),C("ngModel",n.startTime),d(4),T("name","endTime",e,""),C("ngModel",n.endTime),d(4),T("name","totalTime",e,""),C("ngModel",n.totalTime)}}function Cr(o,i){if(o&1&&(a(0,"option",14),l(1),s()),o&2){let n=i.$implicit;f("value",n._id),d(),b(n.servicename)}}function Sr(o,i){if(o&1&&(a(0,"option",14),l(1),s()),o&2){let n=i.$implicit;f("value",n.level),d(),b(n.level)}}function xr(o,i){if(o&1){let n=w();a(0,"div",16)(1,"label",33),l(2,"Severity Level:"),s(),a(3,"select",29),x("ngModelChange",function(t){p(n);let r=m().$implicit;return S(r.severityLevel,t)||(r.severityLevel=t),h(t)}),g("change",function(){p(n);let t=m().index,r=m();return h(r.updateTotalPriceForSection(t))}),v(4,Sr,2,2,"option",9),s()()}if(o&2){let n=m(),e=n.$implicit,t=n.index;d(3),T("name","severityLevel",t,""),C("ngModel",e.severityLevel),d(),f("ngForOf",e.severityLevels)}}function wr(o,i){if(o&1){let n=w();a(0,"div",34)(1,"h6"),l(2),s(),a(3,"div",35)(4,"div",36)(5,"label",37),l(6,"Length:"),s(),a(7,"input",38),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.length,t)||(r.length=t),h(t)}),g("input",function(){p(n);let t=m(2);return h(t.updateTotalSquareFootage())}),s()(),a(8,"div",36)(9,"label",39),l(10,"Width:"),s(),a(11,"input",38),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.width,t)||(r.width=t),h(t)}),g("input",function(){p(n);let t=m(2);return h(t.updateTotalSquareFootage())}),s()(),a(12,"div",40)(13,"button",41),g("click",function(){let t=p(n).index,r=m().index,c=m();return h(c.removeMeasurement(r,t))}),l(14,"Remove"),s()()()()}if(o&2){let n=i.$implicit,e=i.index,t=m().index;d(2),M("Measurement ",e+1,""),d(5),Ve("name","length",t,"",e,""),C("ngModel",n.length),d(4),Ve("name","width",t,"",e,""),C("ngModel",n.width)}}function Mr(o,i){if(o&1){let n=w();a(0,"div",25)(1,"h5"),l(2),s(),a(3,"div",16)(4,"label",26),l(5,"Section Name:"),s(),a(6,"input",27),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.sectionName,t)||(r.sectionName=t),h(t)}),s()(),a(7,"div",16)(8,"label",28),l(9,"Service Type:"),s(),a(10,"select",29),x("ngModelChange",function(t){let r=p(n).$implicit;return S(r.serviceType._id,t)||(r.serviceType._id=t),h(t)}),g("change",function(){let t=p(n).index,r=m();return h(r.updateSeverityLevelsForSection(t))}),v(11,Cr,2,2,"option",9),s()(),v(12,xr,5,4,"div",30)(13,wr,15,9,"div",31),a(14,"button",32),g("click",function(){let t=p(n).index,r=m();return h(r.addMeasurement(t))}),l(15,"Add Measurement"),s(),a(16,"button",24),g("click",function(){let t=p(n).index,r=m();return h(r.removeSection(t))}),l(17,"Remove Section"),s()()}if(o&2){let n=i.$implicit,e=i.index,t=m();d(2),M("Section ",e+1,""),d(4),T("name","sectionName",e,""),C("ngModel",n.sectionName),d(4),T("name","serviceType",e,""),C("ngModel",n.serviceType._id),d(),f("ngForOf",t.services),d(),f("ngIf",n.severityLevels.length>0),d(),f("ngForOf",n.measurements)}}var Zi=(()=>{let i=class i{constructor(e){this.cdr=e,this.job={jobTitle:"",customer:"",totalSquareFootage:0,totalprice:0,sections:[],datesOfService:[{_id:"",date:"",startTime:"",endTime:"",totalTime:""}],numberofcontractors:0,isRecurring:!1,contractorTotalPay:0,contractorRate:0,_id:""},this.clients=[],this.services=[],this.contractors=[],this.save=new N,this.close=new N}ngOnInit(){this.job.isRecurring&&(this.job.datesOfService=this.getRecurringDates(this.job.datesOfService))}onSubmit(){this.save.emit(this.job)}onClose(){this.close.emit()}addDateOfService(){this.job.datesOfService.push({_id:"",date:"",startTime:"",endTime:"",totalTime:""}),this.cdr.detectChanges()}removeDateOfService(e){this.job.datesOfService.splice(e,1),this.cdr.detectChanges()}addSection(){this.job.sections.push({jobId:"",sectionName:"",serviceType:{servicename:"",severities:[],_id:""},severityLevel:"",severityLevels:[],measurements:[],totalprice:0,contractorPay:0,totalTime:0,_id:""}),this.cdr.detectChanges()}removeSection(e){this.job.sections.splice(e,1),this.updateTotalSquareFootage(),this.cdr.detectChanges()}addMeasurement(e){this.job.sections[e].measurements.push({length:0,width:0}),this.updateTotalSquareFootage(),this.cdr.detectChanges()}removeMeasurement(e,t){this.job.sections[e].measurements.splice(t,1),this.updateTotalSquareFootage(),this.cdr.detectChanges()}updateSeverityLevelsForSection(e){let t=this.job.sections[e],r=this.services.find(c=>c._id===t.serviceType._id);r?t.severityLevels=r.severities:t.severityLevels=[],this.updateTotalPriceForSection(e),this.cdr.detectChanges()}updateTotalPriceForSection(e){let t=this.job.sections[e],r=this.services.find(u=>u._id===t.serviceType._id),c=r?.severities.find(u=>u.level===t.severityLevel);if(r&&c){let u=t.measurements.reduce((y,E)=>y+E.length*E.width,0);t.totalprice=c.rate*u,t.totalTime=this.calculateTotalTimeForSection(u,c.estimatedTime),t.contractorPay=this.calculateContractorPayForSection(t.totalTime,c.contractorrate),this.updateTotalPrice()}this.cdr.detectChanges()}updateTotalSquareFootage(){let e=0;this.job.sections.forEach(t=>{t.measurements.forEach(r=>{e+=r.length*r.width})}),this.job.totalSquareFootage=e,this.updateTotalPrice(),this.cdr.detectChanges()}updateTotalPrice(){this.job.totalprice=this.job.sections.reduce((e,t)=>e+(t.totalprice||0),0),this.job.contractorTotalPay=this.job.sections.reduce((e,t)=>e+(t.contractorPay||0),0),this.job.isRecurring&&(this.job.multiDateTotalPrice=this.job.datesOfService.length*this.job.totalprice),this.cdr.detectChanges()}calculateTotalTime(e){if(e.startTime&&e.endTime){let t=new Date(`1970-01-01T${e.startTime}:00`),r=new Date(`1970-01-01T${e.endTime}:00`);if(t>=r)e.totalTime="Invalid time range";else{let c=(r.getTime()-t.getTime())/1e3/60,u=Math.floor(c/60),y=c%60;e.totalTime=`${u}h ${y}m`}}this.cdr.detectChanges()}calculateTotalTimeForSection(e,t){return e/1e3*(t/60)}calculateContractorPayForSection(e,t){return e*t}getRecurringDates(e){return e}};i.\u0275fac=function(t){return new(t||i)(_(ne))},i.\u0275cmp=O({type:i,selectors:[["app-job-edit-form"]],inputs:{job:"job",clients:"clients",services:"services",contractors:"contractors"},outputs:{save:"save",close:"close"},standalone:!0,features:[F],decls:24,vars:5,consts:[[1,"modal"],[1,"modal-content"],[1,"close",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","jobTitle"],["type","text","name","jobTitle","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","customer"],["name","customer","required","",1,"form-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","date-service-container mb-4 p-3 border rounded bg-white",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary","mb-3",3,"click"],["class","section-container mb-4 p-3 border rounded bg-white",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary"],[3,"value"],[1,"date-service-container","mb-4","p-3","border","rounded","bg-white"],[1,"form-group","mb-3"],["for","date"],["type","date","required","",1,"form-control",3,"ngModelChange","ngModel","name"],["for","startTime"],["type","time","required","",1,"form-control",3,"ngModelChange","change","ngModel","name"],["for","endTime"],["for","totalTime"],["type","text","readonly","",1,"form-control",3,"ngModelChange","ngModel","name"],["type","button",1,"btn","btn-danger","ms-2",3,"click"],[1,"section-container","mb-4","p-3","border","rounded","bg-white"],["for","sectionName"],["type","text","required","",1,"form-control",3,"ngModelChange","ngModel","name"],["for","serviceType"],["required","",1,"form-select",3,"ngModelChange","change","ngModel","name"],["class","form-group mb-3",4,"ngIf"],["class","measurement-container mb-2 p-2 border rounded",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary",3,"click"],["for","severityLevel"],[1,"measurement-container","mb-2","p-2","border","rounded"],[1,"row"],[1,"col"],["for","length"],["type","number","required","",1,"form-control",3,"ngModelChange","input","ngModel","name"],["for","width"],[1,"col-2","d-flex","align-items-end"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"div",1)(2,"span",2),g("click",function(){return r.onClose()}),l(3,"\xD7"),s(),a(4,"h3"),l(5,"Edit Job"),s(),a(6,"form",3),g("ngSubmit",function(){return r.onSubmit()}),a(7,"div",4)(8,"label",5),l(9,"Job Title:"),s(),a(10,"input",6),x("ngModelChange",function(u){return S(r.job.jobTitle,u)||(r.job.jobTitle=u),u}),s()(),a(11,"div",4)(12,"label",7),l(13,"Customer:"),s(),a(14,"select",8),x("ngModelChange",function(u){return S(r.job.customer,u)||(r.job.customer=u),u}),v(15,br,2,2,"option",9),s()(),v(16,yr,21,13,"div",10),a(17,"button",11),g("click",function(){return r.addDateOfService()}),l(18,"Add Date of Service"),s(),v(19,Mr,18,10,"div",12),a(20,"button",11),g("click",function(){return r.addSection()}),l(21,"Add Section"),s(),a(22,"button",13),l(23,"Update Job"),s()()()()),t&2&&(d(10),C("ngModel",r.job.jobTitle),d(4),C("ngModel",r.job.customer),d(),f("ngForOf",r.clients),d(),f("ngForOf",r.job.datesOfService),d(3),f("ngForOf",r.job.sections))},dependencies:[I,k,j,U,Y,ge,fe,q,Se,ee,z,Q,K,se,oe],styles:[".modal[_ngcontent-%COMP%]{display:block;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#00000080}.modal-content[_ngcontent-%COMP%]{background-color:#fff;margin:10% auto;padding:20px;border:1px solid #888;width:90%;max-width:600px;border-radius:10px;box-shadow:0 4px 8px #0003}"]});let o=i;return o})();function Tr(o,i){o&1&&(a(0,"div")(1,"p"),l(2,"No jobs available."),s()())}function Er(o,i){if(o&1){let n=w();a(0,"li",9)(1,"strong"),l(2),s(),a(3,"div",10)(4,"button",11),g("click",function(){let t=p(n).$implicit,r=m(2);return h(r.openJobModal(t))}),l(5,"View Details"),s(),a(6,"button",12),g("click",function(){let t=p(n).$implicit,r=m(2);return h(r.deleteJob(t._id))}),l(7,"Delete"),s()()()}if(o&2){let n=i.$implicit;d(2),b(n.jobTitle)}}function Vr(o,i){if(o&1&&(a(0,"ul",7),v(1,Er,8,1,"li",8),s()),o&2){let n=m();d(),f("ngForOf",n.uniqueJobs)}}function Dr(o,i){if(o&1){let n=w();a(0,"div",13)(1,"div",14)(2,"span",15),g("click",function(){p(n);let t=m();return h(t.toggleAddJobModal())}),l(3,"\xD7"),s(),a(4,"h3"),l(5,"Add Job"),s(),a(6,"app-job-form",16),g("save",function(t){p(n);let r=m();return h(r.addJob(t))})("close",function(){p(n);let t=m();return h(t.toggleAddJobModal())}),s()()()}if(o&2){let n=m();d(6),f("job",n.newJob)("clients",n.clients)("services",n.services)("contractors",n.contractors)}}function Or(o,i){if(o&1){let n=w();a(0,"div",13)(1,"div",14)(2,"span",15),g("click",function(){p(n);let t=m();return h(t.toggleAddJobModal())}),l(3,"\xD7"),s(),a(4,"h3"),l(5,"Edit Job"),s(),a(6,"app-job-edit-form",16),g("save",function(t){p(n);let r=m();return h(r.updateJob(t))})("close",function(){p(n);let t=m();return h(t.toggleAddJobModal())}),s()()()}if(o&2){let n=m();d(6),f("job",n.editingJob)("clients",n.clients)("services",n.services)("contractors",n.contractors)}}function Fr(o,i){if(o&1){let n=w();a(0,"app-job-details",17),g("close",function(){p(n);let t=m();return h(t.hideModal())})("edit",function(t){p(n);let r=m();return h(r.openEditModal(t))})("delete",function(t){p(n);let r=m();return h(r.deleteJob(t))}),s()}if(o&2){let n=m();f("job",n.editingJob)("clients",n.clients)("contractors",n.contractors)}}var Xi=(()=>{let i=class i{constructor(e,t,r,c,u,y){this.jobService=e,this.clientService=t,this.serviceService=r,this.notificationService=c,this.authService=u,this.cdr=y,this.jobs=[],this.clients=[],this.services=[],this.severityLevels=[],this.newJob={jobTitle:"",customer:"",totalSquareFootage:0,totalprice:0,sections:[],datesOfService:[{_id:"",date:"",startTime:"",endTime:"",totalTime:""}],numberofcontractors:0,isRecurring:!1,contractorTotalPay:0,contractorRate:0,_id:""},this.recurrence="",this.recurrenceCount=1,this.editingJob=null,this.modalVisible=!1,this.addJobModalVisible=!1,this.showAddJob=!1,this.jobDetailsVisibility={},this.jobSectionsVisibility={},this.sectionVisibility={},this.isEditMode=!1,this.contractors=[],this.jobType=""}ngOnInit(){this.getJobs(),this.getClients(),this.getServices(),this.getContractors(),this.notificationService.clientUpdated$.subscribe(()=>this.getClients()),this.notificationService.serviceUpdated$.subscribe(()=>this.getServices()),this.jobService.jobAdded$.subscribe(e=>{this.jobs.findIndex(r=>r._id===e._id)===-1&&this.jobs.push(e),this.resetNewJob(),this.cdr.detectChanges()}),this.jobService.jobDeleted$.subscribe(e=>{this.jobs=this.jobs.filter(t=>t._id!==e),this.cdr.detectChanges()}),this.jobService.dateOfServiceDeleted$.subscribe(({jobId:e,dateId:t})=>{let r=this.jobs.find(c=>c._id===e);r&&(r.datesOfService=r.datesOfService.filter(c=>c._id!==t),r.datesOfService.length===0&&(this.jobs=this.jobs.filter(c=>c._id!==e)),this.cdr.detectChanges())}),this.notificationService.jobUpdated$.subscribe(()=>{this.getJobs()})}getJobs(){console.log("Fetching jobs"),this.jobService.getJobs().subscribe(e=>{console.log("Jobs fetched:",e),this.jobs=e,this.jobs.forEach(t=>{this.jobDetailsVisibility[t._id]=!1,this.jobSectionsVisibility[t._id]=!1,this.sectionVisibility[t._id]=new Array(t.sections.length).fill(!1)}),this.cdr.detectChanges()})}get uniqueJobs(){let e={};return this.jobs.forEach(r=>{r.isRecurring&&(e[r.jobTitle]?e[r.jobTitle].datesOfService.push(...r.datesOfService):e[r.jobTitle]=r,e[r.jobTitle].multiDateTotalPrice=e[r.jobTitle].datesOfService.length*r.totalprice)}),[...this.jobs.filter(r=>!r.isRecurring),...Object.values(e)]}getClients(){console.log("Fetching clients"),this.clientService.getClients().subscribe(e=>{console.log("Clients fetched:",e),this.clients=e})}getServices(){console.log("Fetching services"),this.serviceService.getServices().subscribe(e=>{console.log("Services fetched:",e),this.services=e})}getContractors(){console.log("Fetching contractors"),this.authService.getUsersByRole("contractor").subscribe(e=>{console.log("Contractors fetched:",e),this.contractors=e})}getClientName(e){let t=this.clients.find(r=>r._id===e);return t?t.clientname:"Unknown"}getContractorName(e){let t=this.contractors.find(r=>r._id===e);return t?t.email:"Unknown"}toggleAddJob(){this.showAddJob=!this.showAddJob,this.jobType=""}toggleAddJobModal(){this.addJobModalVisible=!this.addJobModalVisible,this.jobType="",this.isEditMode=!1,this.editingJob=null}setJobType(e){this.jobType=e}openJobModal(e){this.editingJob=D({},e),this.isEditMode=!1,this.modalVisible=!0}openEditModal(e){this.editingJob=D({},e),this.updateSeverityLevels(!0),this.isEditMode=!0,this.modalVisible=!0,this.addJobModalVisible=!0}hideModal(){this.modalVisible=!1,this.editingJob=null}updateJob(e){e&&(e.sections.forEach(t=>{let r=this.services.find(u=>u._id===t.serviceType._id),c=r?.severities.find(u=>u.level===t.severityLevel);if(r&&c){t.serviceType=r;let u=t.measurements.reduce((y,E)=>y+E.length*E.width,0);t.totalprice=c.rate*u,t.totalTime=this.calculateTotalTimeForSection(u,c.estimatedTime),t.contractorPay=this.calculateContractorPayForSection(t.totalTime,c.contractorrate)}}),e.totalprice=this.calculateTotalJobPrice(e),e.contractorTotalPay=this.calculateTotalContractorPay(e),e.isRecurring&&(e.multiDateTotalPrice=e.datesOfService.length*e.totalprice),this.jobService.updateJob(e._id,e).subscribe({next:()=>{let t=this.jobs.findIndex(r=>r._id===e._id);t!==-1&&(this.jobs[t]=e),this.hideModal(),this.toggleAddJobModal(),this.notificationService.notifyJobUpdated(),this.cdr.detectChanges()},error:t=>{console.error("Error updating job:",t)}}))}deleteJob(e){this.jobService.deleteJob(e).subscribe(()=>{this.jobs=this.jobs.filter(t=>t._id!==e),delete this.jobDetailsVisibility[e],delete this.jobSectionsVisibility[e],delete this.sectionVisibility[e],this.notificationService.notifyJobUpdated(),this.cdr.detectChanges()})}deleteDateOfService(e,t){this.jobService.deleteDateOfService(e,t).subscribe(()=>{let r=this.jobs.find(c=>c._id===e);r&&(r.datesOfService=r.datesOfService.filter(c=>c._id!==t),this.editingJob&&this.editingJob._id===e&&(this.editingJob.datesOfService=r.datesOfService),r.datesOfService.length===0&&(this.deleteJob(e),this.hideModal())),this.notificationService.notifyJobUpdated(),this.cdr.detectChanges()})}updateSeverityLevels(e=!1){let t=e?this.editingJob:this.newJob,r=this.services.find(c=>c._id===t.sections[0].serviceType._id);r?this.severityLevels=r.severities:this.severityLevels=[],this.updateTotalPrice(e)}updateSeverityLevelsForSection(e,t=!1){let c=(t?this.editingJob:this.newJob)?.sections[e],u=this.services.find(y=>y._id===c?.serviceType._id);u?c.severityLevels=u.severities:c.severityLevels=[],this.updateTotalPriceForSection(e,t)}getSeverityRate(e,t){let c=this.services.find(u=>u._id===e)?.severities.find(u=>u.level===t);return c?c.rate:0}addJob(e){e.sections.forEach(t=>{let r=this.services.find(u=>u._id===t.serviceType._id),c=r?.severities.find(u=>u.level===t.severityLevel);if(r&&c){t.serviceType=r;let u=t.measurements.reduce((y,E)=>y+E.length*E.width,0);t.totalprice=c.rate*u,t.totalTime=this.calculateTotalTimeForSection(u,c.estimatedTime),t.contractorPay=this.calculateContractorPayForSection(t.totalTime,c.contractorrate)}}),e.totalprice=this.calculateTotalJobPrice(e),e.contractorTotalPay=this.calculateTotalContractorPay(e),this.jobType==="recurring"?this.addRecurringJob(e):this.jobService.addJob(e).subscribe(()=>{this.getJobs(),this.showAddJob=!1,this.notificationService.notifyJobUpdated(),this.toggleAddJobModal()})}addRecurringJob(e){let t=new Date(e.datesOfService[0].date),r=Math.min(this.recurrenceCount,50),c=[];for(let u=0;u<r;u++){let y=D({},e.datesOfService[0]);switch(this.recurrence){case"daily":y.date=this.addDays(t,u).toISOString().split("T")[0];break;case"weekly":y.date=this.addDays(t,u*7).toISOString().split("T")[0];break;case"bi-weekly":y.date=this.addDays(t,u*14).toISOString().split("T")[0];break;case"tri-weekly":y.date=this.addDays(t,u*21).toISOString().split("T")[0];break;case"monthly":y.date=this.addMonths(t,u).toISOString().split("T")[0];break;case"bi-monthly":y.date=this.addMonths(t,u*2).toISOString().split("T")[0];break;case"quarterly":y.date=this.addMonths(t,u*3).toISOString().split("T")[0];break;case"semi-annually":y.date=this.addMonths(t,u*6).toISOString().split("T")[0];break;case"annually":y.date=this.addYears(t,u).toISOString().split("T")[0];break}c.push(y)}e.datesOfService=c,e.multiDateTotalPrice=r*e.totalprice,this.jobService.addJob(e).subscribe(()=>{this.getJobs(),this.showAddJob=!1,this.notificationService.notifyJobUpdated(),this.toggleAddJobModal()})}addDays(e,t){let r=new Date(e);return r.setDate(r.getDate()+t),r}addMonths(e,t){let r=new Date(e);return r.setMonth(r.getMonth()+t),r}addYears(e,t){let r=new Date(e);return r.setFullYear(r.getFullYear()+t),r}resetNewJob(){this.newJob={jobTitle:"",customer:"",totalSquareFootage:0,totalprice:0,sections:[],datesOfService:[{_id:"",date:"",startTime:"",endTime:"",totalTime:""}],numberofcontractors:0,isRecurring:!1,contractorTotalPay:0,contractorRate:0,_id:""},this.recurrence="",this.recurrenceCount=1,this.severityLevels=[],this.jobType="",this.cdr.detectChanges()}addSection(e=!1){let t={jobId:"",sectionName:"",serviceType:{servicename:"",severities:[],_id:""},severityLevel:"",severityLevels:[],measurements:[],totalprice:0,contractorPay:0,totalTime:0,_id:""};e&&this.editingJob?(this.editingJob.sections.push(t),this.sectionVisibility[this.editingJob._id].push(!1)):this.newJob.sections.push(t),this.cdr.detectChanges()}removeSection(e,t=!1){t&&this.editingJob?(this.editingJob.sections.splice(e,1),this.sectionVisibility[this.editingJob._id].splice(e,1)):this.newJob.sections.splice(e,1),this.updateTotalSquareFootage(t),this.cdr.detectChanges()}addMeasurement(e,t=!1){let r={length:0,width:0};t&&this.editingJob?this.editingJob.sections[e].measurements.push(r):this.newJob.sections[e].measurements.push(r),this.updateTotalSquareFootage(t),this.cdr.detectChanges()}removeMeasurement(e,t,r=!1){r&&this.editingJob?this.editingJob.sections[e].measurements.splice(t,1):this.newJob.sections[e].measurements.splice(t,1),this.updateTotalSquareFootage(r),this.cdr.detectChanges()}updateTotalSquareFootage(e=!1){let t=0;(e?this.editingJob:this.newJob)?.sections.forEach(c=>{c.measurements.forEach(u=>{t+=u.length*u.width})}),e&&this.editingJob?this.editingJob.totalSquareFootage=t:this.newJob.totalSquareFootage=t,this.updateTotalPrice(e)}updateTotalPrice(e=!1){let t=e?this.editingJob:this.newJob;t.totalprice=this.calculateTotalJobPrice(t),t.contractorTotalPay=this.calculateTotalContractorPay(t),t.isRecurring&&(t.multiDateTotalPrice=t.datesOfService.length*t.totalprice)}updateTotalPriceForSection(e,t=!1){let c=(t?this.editingJob:this.newJob)?.sections[e],u=this.services.find(E=>E._id===c?.serviceType._id),y=u?.severities.find(E=>E.level===c?.severityLevel);if(u&&y){let E=c.measurements.reduce((A,xe)=>A+xe.length*xe.width,0);c.totalprice=y.rate*E,c.totalTime=this.calculateTotalTimeForSection(E,y.estimatedTime),c.contractorPay=this.calculateContractorPayForSection(c.totalTime,y.contractorrate),this.updateTotalPrice(t)}}addDateOfService(e=!1){let t={_id:"",date:"",startTime:"",endTime:"",totalTime:""};e&&this.editingJob?this.editingJob.datesOfService.push(t):this.newJob.datesOfService.push(t),this.cdr.detectChanges()}removeDateOfService(e,t=!1){t&&this.editingJob?this.editingJob.datesOfService.splice(e,1):this.newJob.datesOfService.splice(e,1),this.editingJob&&this.editingJob.datesOfService.length===0&&this.deleteJob(this.editingJob._id),this.notificationService.notifyJobUpdated(),this.cdr.detectChanges()}calculateTotalTime(e){if(e.startTime&&e.endTime){let t=new Date(`1970-01-01T${e.startTime}:00`),r=new Date(`1970-01-01T${e.endTime}:00`);if(t>=r)e.totalTime="Invalid time range";else{let c=(r.getTime()-t.getTime())/1e3/60,u=Math.floor(c/60),y=c%60;e.totalTime=`${u}h ${y}m`}}}calculateHours(e){let t=e.split(" "),r=0,c=0;return t.forEach(u=>{u.endsWith("h")?r+=parseInt(u.slice(0,-1),10):u.endsWith("m")&&(c+=parseInt(u.slice(0,-1),10))}),r+c/60}calculateTotalTimeInHours(e){return this.calculateHours(e.measurements.reduce((t,r)=>t+`${r.length*r.width}h `,""))}calculateTotalTimeForSection(e,t){return e/1e3*(t/60)}calculateTotalJobPrice(e){return e.sections.reduce((t,r)=>t+(r.totalprice||0),0)}calculateTotalContractorPay(e){return e.sections.reduce((t,r)=>t+(r.contractorPay||0),0)}getClosestServiceDate(e){if(!e.length)return null;let t=new Date().toISOString().split("T")[0],r=e.filter(c=>c.date>=t);return r.length?r[0]:e[0]}calculateContractorPayForSection(e,t){return e*t}};i.\u0275fac=function(t){return new(t||i)(_(ve),_(_e),_(Je),_(Z),_(te),_(ne))},i.\u0275cmp=O({type:i,selectors:[["app-job"]],viewQuery:function(t,r){if(t&1&&bt(mt,5),t&2){let c;yt(c=Ct())&&(r.calendarComponent=c.first)}},standalone:!0,features:[F],decls:10,vars:5,consts:[[1,"container"],[1,"text-center","my-4"],[1,"btn","btn-primary","mb-3",3,"click"],[4,"ngIf"],["class","list-group",4,"ngIf"],["class","modal",4,"ngIf"],[3,"job","clients","contractors","close","edit","delete",4,"ngIf"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"btn-group"],[1,"btn","btn-outline-secondary","btn-sm","me-2",3,"click"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"modal"],[1,"modal-content"],[1,"close",3,"click"],[3,"save","close","job","clients","services","contractors"],[3,"close","edit","delete","job","clients","contractors"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"h2",1),l(2,"Jobs"),s(),a(3,"button",2),g("click",function(){return r.toggleAddJobModal()}),l(4,"Add Job"),s(),v(5,Tr,3,0,"div",3)(6,Vr,2,1,"ul",4),s(),v(7,Dr,7,4,"div",5)(8,Or,7,4,"div",5)(9,Fr,1,3,"app-job-details",6)),t&2&&(d(5),f("ngIf",r.jobs.length===0),d(),f("ngIf",r.jobs.length>0),d(),f("ngIf",r.addJobModalVisible&&!r.isEditMode),d(),f("ngIf",r.addJobModalVisible&&r.isEditMode),d(),f("ngIf",r.modalVisible&&r.editingJob&&!r.isEditMode))},dependencies:[I,k,j,U,zi,Qi,Yi,Zi],styles:[".container[_ngcontent-%COMP%]{padding:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.btn[_ngcontent-%COMP%]{margin-top:10px}.list-group-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;border:1px solid #ddd;border-radius:8px;padding:15px;background-color:#f9f9f9}.list-group-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-bottom:5px}.btn-group[_ngcontent-%COMP%]{display:flex;gap:10px}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px 20px;margin:0 10px;border-radius:5px;font-size:1em;cursor:pointer;transition:background-color .3s,transform .3s}.modal[_ngcontent-%COMP%]{display:block;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#00000080}.modal-content[_ngcontent-%COMP%]{background-color:#fff;margin:10% auto;padding:20px;border:1px solid #888;width:90%;max-width:600px;border-radius:10px;box-shadow:0 4px 8px #0003}.close[_ngcontent-%COMP%]{color:#aaa;float:right;font-size:28px;font-weight:700;cursor:pointer}.close[_ngcontent-%COMP%]:hover, .close[_ngcontent-%COMP%]:focus{color:#000;text-decoration:none;cursor:pointer}"]});let o=i;return o})();function Ir(o,i){if(o&1&&(a(0,"option",19),l(1),s()),o&2){let n=i.$implicit;f("value",n._id),d(),b(n.servicename)}}function Pr(o,i){if(o&1&&(a(0,"option",19),l(1),s()),o&2){let n=i.$implicit;f("value",n.level),d(),b(n.level)}}function jr(o,i){if(o&1&&(a(0,"li"),l(1),s()),o&2){let n=i.$implicit,e=m(3);d(),b(e.getContractorName(n))}}function Ar(o,i){if(o&1&&(a(0,"li")(1,"strong"),l(2,"Other Contractors:"),s(),a(3,"ul",28),v(4,jr,2,1,"li",29),s()()),o&2){let n=m().$implicit;d(4),f("ngForOf",n.contractors)}}function kr(o,i){if(o&1){let n=w();a(0,"button",30),g("click",function(){p(n);let t=m().$implicit,r=m();return h(r.claimJob(t))}),l(1,"Claim"),s()}}function Jr(o,i){if(o&1){let n=w();a(0,"li",20)(1,"div",21)(2,"strong"),l(3),s(),l(4),V(5,"span",22),a(6,"span",23),l(7),s()(),a(8,"ul",24)(9,"li")(10,"strong"),l(11,"Service:"),s(),l(12),s(),a(13,"li")(14,"strong"),l(15,"Severity:"),s(),l(16),s(),a(17,"li")(18,"strong"),l(19,"Total Square Footage:"),s(),l(20),s(),a(21,"li")(22,"strong"),l(23,"Closest Date of Service:"),s(),l(24),a(25,"button",25),g("click",function(){let t=p(n).$implicit,r=m();return h(r.showAllDates(t))}),l(26,"Show All Dates"),s()(),a(27,"li")(28,"strong"),l(29,"Total Time:"),s(),l(30),s(),v(31,Ar,5,1,"li",26),a(32,"li")(33,"strong"),l(34,"Contractor Total Pay:"),s(),l(35),R(36,"currency"),s()(),v(37,kr,2,0,"button",27),s()}if(o&2){let n=i.$implicit,e=m();d(3),b(n.jobTitle),d(),M("",e.getClientName(n.customer)," "),d(),f("ngStyle",e.getJobTypeStyle(n)),d(2),b(e.getJobTypeText(n)),d(5),M(" ",n.sections[0].serviceType.servicename,""),d(4),M(" ",n.sections[0].severityLevel,""),d(4),M(" ",n.totalSquareFootage,""),d(4),St(" ",e.getClosestDateOfService(n).date," (",e.getClosestDateOfService(n).startTime," - ",e.getClosestDateOfService(n).endTime,") "),d(6),M(" ",e.getTotalTime(n)," hours"),d(),f("ngIf",n.contractors&&n.contractors.length>1),d(4),M(" ",L(36,14,n.contractorTotalPay),""),d(2),f("ngIf",e.canClaimJob(n))}}function Nr(o,i){if(o&1&&(a(0,"li"),l(1),s()),o&2){let n=i.$implicit,e=m(3);d(),b(e.getContractorName(n))}}function Rr(o,i){if(o&1&&(a(0,"li")(1,"strong"),l(2,"Other Contractors:"),s(),a(3,"ul",28),v(4,Nr,2,1,"li",29),s()()),o&2){let n=m().$implicit;d(4),f("ngForOf",n.contractors)}}function Lr(o,i){if(o&1){let n=w();a(0,"li",20)(1,"div",21)(2,"strong"),l(3),s(),l(4),V(5,"span",22),a(6,"span",23),l(7),s()(),a(8,"ul",24)(9,"li")(10,"strong"),l(11,"Service:"),s(),l(12),s(),a(13,"li")(14,"strong"),l(15,"Severity:"),s(),l(16),s(),a(17,"li")(18,"strong"),l(19,"Total Square Footage:"),s(),l(20),s(),a(21,"li")(22,"strong"),l(23,"Closest Date of Service:"),s(),l(24),a(25,"button",25),g("click",function(){let t=p(n).$implicit,r=m();return h(r.showAllDates(t))}),l(26,"Show All Dates"),s()(),a(27,"li")(28,"strong"),l(29,"Total Time:"),s(),l(30),s(),v(31,Rr,5,1,"li",26),a(32,"li")(33,"strong"),l(34,"Contractor Total Pay:"),s(),l(35),R(36,"currency"),s()(),a(37,"span",31),l(38,"You have claimed this job"),s()()}if(o&2){let n=i.$implicit,e=m();d(3),b(n.jobTitle),d(),M("",e.getClientName(n.customer)," "),d(),f("ngStyle",e.getJobTypeStyle(n)),d(2),b(e.getJobTypeText(n)),d(5),M(" ",n.sections[0].serviceType.servicename,""),d(4),M(" ",n.sections[0].severityLevel,""),d(4),M(" ",n.totalSquareFootage,""),d(4),St(" ",e.getClosestDateOfService(n).date," (",e.getClosestDateOfService(n).startTime," - ",e.getClosestDateOfService(n).endTime,") "),d(6),M(" ",e.getTotalTime(n)," hours"),d(),f("ngIf",n.contractors&&n.contractors.length>1),d(4),M(" ",L(36,13,n.contractorTotalPay),"")}}function Ur(o,i){if(o&1&&(a(0,"tr")(1,"td"),l(2),s(),a(3,"td"),l(4),s(),a(5,"td"),l(6),s(),a(7,"td"),l(8),s(),a(9,"td"),l(10),s(),a(11,"td"),l(12),s(),a(13,"td"),l(14),R(15,"currency"),s()()),o&2){let n=i.$implicit,e=m(2);d(2),b(n.date),d(2),b(n.startTime),d(2),b(n.endTime),d(2),b(n.totalTime),d(2),b(e.getServiceName(e.modalJob)),d(2),b(e.getSeverityLevel(e.modalJob)),d(2),b(L(15,7,e.getContractorPay(e.modalJob,n)))}}function Wr(o,i){if(o&1){let n=w();a(0,"div",32)(1,"div",33)(2,"span",34),g("click",function(){p(n);let t=m();return h(t.hideModal())}),l(3,"\xD7"),s(),a(4,"h3"),l(5,"All Dates of Service"),s(),a(6,"table",35)(7,"thead")(8,"tr")(9,"th"),l(10,"Date"),s(),a(11,"th"),l(12,"Start Time"),s(),a(13,"th"),l(14,"End Time"),s(),a(15,"th"),l(16,"Total Time"),s(),a(17,"th"),l(18,"Service"),s(),a(19,"th"),l(20,"Severity"),s(),a(21,"th"),l(22,"Contractor Pay"),s()()(),a(23,"tbody"),v(24,Ur,16,9,"tr",29),s()(),a(25,"div",36)(26,"strong"),l(27,"Total Pay:"),s(),l(28),R(29,"currency"),s()()()}if(o&2){let n=m();d(24),f("ngForOf",n.modalJob==null?null:n.modalJob.datesOfService),d(4),M(" ",L(29,2,n.getTotalPay(n.modalJob))," ")}}var Ki=(()=>{let i=class i{constructor(e,t,r,c,u){this.clientService=e,this.authService=t,this.jobService=r,this.notificationService=c,this.fb=u,this.jobs=[],this.clients=[],this.currentUserId=null,this.userServices=[],this.availableJobs=[],this.claimedJobs=[],this.filteredAvailableJobs=[],this.filteredClaimedJobs=[],this.modalVisible=!1,this.modalJob=null,this.availableServices=[],this.availableSeverities=[],this.filteredSeverities=[],this.clientSearchTerm="",this.serviceSearchTerm="",this.filterForm=this.fb.group({searchTerm:[""],serviceType:[""],severity:[""],payRange:[1e3],dateType:[""],startDate:[""],endDate:[""]})}ngOnInit(){this.loadClients(),this.loadCurrentUser(),this.categorizeJobs(),this.loadAvailableFilters(),this.authService.loginStatus$.subscribe(()=>{this.loadCurrentUser(),this.categorizeJobs()}),this.jobService.jobAdded$.subscribe(()=>{this.categorizeJobs()})}ngOnChanges(e){e.jobs&&this.categorizeJobs()}loadClients(){this.clientService.getClients().subscribe(e=>{this.clients=e})}getClientName(e){if(!e)return"Unknown";let t=this.clients.find(r=>r._id===e);return t?t.clientname:"Unknown"}getContractorName(e){return e}loadCurrentUser(){let e=localStorage.getItem("currentUser");if(e){let t=JSON.parse(e);this.currentUserId=t._id,this.userServices=t.services||[]}}categorizeJobs(){this.availableJobs=this.jobs.filter(e=>this.canClaimJob(e)),this.claimedJobs=this.jobs.filter(e=>this.isClaimedByUser(e)),this.applyFilters()}canClaimJob(e){if(!this.currentUserId)return!1;let t=e.contractors?.includes(this.currentUserId)??!1,r=(e.contractors?.length??0)>=e.numberofcontractors,c=e.sections.some(u=>this.userServices.includes(u.serviceType._id));return!t&&!r&&c}isClaimedByUser(e){return this.currentUserId?e.contractors?.includes(this.currentUserId)??!1:!1}claimJob(e){this.currentUserId&&this.canClaimJob(e)&&this.jobService.claimJob(e._id,this.currentUserId).subscribe({next:t=>{this.availableJobs=this.availableJobs.filter(r=>r._id!==t._id),this.claimedJobs.push(t),this.notificationService.notifyJobUpdated()},error:t=>{console.error("Error claiming job:",t)}})}getClosestDateOfService(e){let t=new Date().toISOString().split("T")[0],r=e.datesOfService.filter(c=>c.date>=t);return r.length?r[0]:e.datesOfService[0]}getTotalTime(e){return e.sections.reduce((t,r)=>t+(r.totalTime||0),0)}showAllDates(e){this.modalJob=e,this.modalVisible=!0}hideModal(){this.modalVisible=!1,this.modalJob=null}getJobTypeStyle(e){let t="";return e.datesOfService.length===1?t="#007bff":e.isRecurring?t="#ff8c00":t="#fdd835",{"background-color":t}}getJobTypeText(e){return e.datesOfService.length===1?"Single Date Job":e.isRecurring?"Recurring Job":"Multiple Date Job"}getEstimatedTime(e){return e?e.sections.reduce((t,r)=>{let c=r.severityLevels.find(u=>u.level===r.severityLevel);return t+(c?.estimatedTime||0)},0)+" hours":""}getContractorPay(e,t){return e?e.sections.reduce((r,c)=>{let u=c.severityLevels.find(y=>y.level===c.severityLevel);return r+(u?.contractorrate||0)},0):0}getTotalPay(e){return e?e.datesOfService.reduce((t,r)=>t+this.getContractorPay(e,r),0):0}getServiceName(e){return!e||!e.sections.length?"":e.sections[0].serviceType.servicename}getSeverityLevel(e){return!e||!e.sections.length?"":e.sections[0].severityLevel}loadAvailableFilters(){this.jobs.forEach(e=>{e.sections.forEach(t=>{this.availableServices.some(r=>r._id===t.serviceType._id)||this.availableServices.push(t.serviceType),t.severityLevels.forEach(r=>{this.availableSeverities.some(c=>c.level===r.level)||this.availableSeverities.push(r)})})})}onServiceTypeChange(){let e=this.filterForm.value.serviceType;if(e){let t=this.availableServices.find(r=>r._id===e);this.filteredSeverities=t?t.severities:[]}else this.filteredSeverities=this.availableSeverities;this.filterForm.patchValue({severity:""})}onPayRangeChange(){this.applyFilters()}onSearchChange(){this.applyFilters()}onDateRangeChange(){this.applyFilters()}applyFilters(){let{searchTerm:e,serviceType:t,severity:r,payRange:c,dateType:u,startDate:y,endDate:E}=this.filterForm.value;this.filteredAvailableJobs=this.availableJobs.filter(A=>{let xe=this.matchesSearchTerm(A,e),pt=t?A.sections.some(be=>be.serviceType._id===t):!0,ht=r?A.sections.some(be=>be.severityLevel===r):!0,gt=A.contractorTotalPay<=c,ft=this.matchesDateType(A,u),_t=this.matchesDateRange(A,y,E);return xe&&pt&&ht&&gt&&ft&&_t}),this.filteredClaimedJobs=this.claimedJobs.filter(A=>{let xe=this.matchesSearchTerm(A,e),pt=t?A.sections.some(be=>be.serviceType._id===t):!0,ht=r?A.sections.some(be=>be.severityLevel===r):!0,gt=A.contractorTotalPay<=c,ft=this.matchesDateType(A,u),_t=this.matchesDateRange(A,y,E);return xe&&pt&&ht&&gt&&ft&&_t})}matchesSearchTerm(e,t){if(!t)return!0;t=t.toLowerCase();let r=this.getClientName(e.customer).toLowerCase(),c=e.sections.map(y=>y.serviceType.servicename.toLowerCase()).join(" "),u=e.jobTitle.toLowerCase();return r.includes(t)||c.includes(t)||u.includes(t)}matchesDateType(e,t){return t?t==="single"?e.datesOfService.length===1:t==="multi"?e.datesOfService.length>1&&!e.isRecurring:t==="recurring"?e.isRecurring:!1:!0}matchesDateRange(e,t,r){if(!t&&!r)return!0;let c=e.datesOfService.map(E=>new Date(E.date).getTime()),u=t?new Date(t).getTime():-1/0,y=r?new Date(r).getTime():1/0;return c.some(E=>E>=u&&E<=y)}};i.\u0275fac=function(t){return new(t||i)(_(_e),_(te),_(ve),_(Z),_(lt))},i.\u0275cmp=O({type:i,selectors:[["app-contractor-jobs"]],inputs:{jobs:"jobs"},standalone:!0,features:[ce,F],decls:53,vars:9,consts:[[1,"contractor-jobs-container"],[3,"ngSubmit","formGroup"],[1,"filter-container"],["type","text","formControlName","searchTerm","placeholder","Search by client, service, or job title",3,"input"],["type","date","formControlName","startDate",3,"change"],["type","date","formControlName","endDate",3,"change"],["formControlName","serviceType",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","severity"],["type","range","formControlName","payRange","min","0","max","1000","step","50",3,"input"],["formControlName","dateType"],["value","single"],["value","multi"],["value","recurring"],["type","submit"],[1,"job-list"],["class","job-item",4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[3,"value"],[1,"job-item"],[1,"job-header"],[1,"job-type-indicator",3,"ngStyle"],[1,"job-type-text"],[1,"job-details"],[1,"btn-show-dates",3,"click"],[4,"ngIf"],["class","btn-claim",3,"click",4,"ngIf"],[1,"contractor-list"],[4,"ngFor","ngForOf"],[1,"btn-claim",3,"click"],[1,"claimed-status"],[1,"modal"],[1,"modal-content"],[1,"close",3,"click"],[1,"dates-table"],[1,"total-pay"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"h2"),l(2,"Available Jobs"),s(),a(3,"form",1),g("ngSubmit",function(){return r.applyFilters()}),a(4,"div",2)(5,"label"),l(6," Search: "),a(7,"input",3),g("input",function(){return r.onSearchChange()}),s()(),a(8,"label"),l(9," Start Date: "),a(10,"input",4),g("change",function(){return r.onDateRangeChange()}),s()(),a(11,"label"),l(12," End Date: "),a(13,"input",5),g("change",function(){return r.onDateRangeChange()}),s()()(),a(14,"div",2)(15,"label"),l(16," Service Type: "),a(17,"select",6),g("change",function(){return r.onServiceTypeChange()}),a(18,"option",7),l(19,"All"),s(),v(20,Ir,2,2,"option",8),s()(),a(21,"label"),l(22," Severity: "),a(23,"select",9)(24,"option",7),l(25,"All"),s(),v(26,Pr,2,2,"option",8),s()(),a(27,"label"),l(28," Pay Range: "),a(29,"input",10),g("input",function(){return r.onPayRangeChange()}),s(),a(30,"span"),l(31),R(32,"currency"),s()(),a(33,"label"),l(34," Date Type: "),a(35,"select",11)(36,"option",7),l(37,"All"),s(),a(38,"option",12),l(39,"Single Date"),s(),a(40,"option",13),l(41,"Multi-Date"),s(),a(42,"option",14),l(43,"Recurring"),s()()(),a(44,"button",15),l(45,"Apply Filters"),s()()(),a(46,"ul",16),v(47,Jr,38,16,"li",17),s(),a(48,"h2"),l(49,"Your Claimed Jobs"),s(),a(50,"ul",16),v(51,Lr,39,15,"li",17),s(),v(52,Wr,30,4,"div",18),s()),t&2&&(d(3),f("formGroup",r.filterForm),d(17),f("ngForOf",r.availableServices),d(6),f("ngForOf",r.filteredSeverities),d(5),b(L(32,7,r.filterForm.value.payRange)),d(16),f("ngForOf",r.filteredAvailableJobs),d(4),f("ngForOf",r.filteredClaimedJobs),d(),f("ngIf",r.modalVisible))},dependencies:[I,k,j,oi,De,U,Y,ge,fe,q,kt,ee,z,Q,ct,ze,Qe],styles:[".contractor-jobs-container[_ngcontent-%COMP%]{padding:20px;background:#fff;border-radius:12px;box-shadow:0 4px 6px #0000001a;font-family:Arial,sans-serif;color:#333}h2[_ngcontent-%COMP%]{font-size:1.5rem;color:#007bff;margin-bottom:20px}.filter-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px}.filter-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex:1 1 200px}.filter-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .filter-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.filter-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;transition:background-color .3s ease}.filter-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.job-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.job-item[_ngcontent-%COMP%]{padding:15px;border:1px solid #e0e0e0;border-radius:8px;margin-bottom:10px;transition:box-shadow .3s ease}.job-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a}.job-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.job-header[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{flex:1;font-size:1.2rem}.job-type-indicator[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;border-radius:50%;margin-left:10px;vertical-align:middle}.job-type-text[_ngcontent-%COMP%]{margin-left:8px;font-size:.9rem;color:#666}.job-details[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.job-details[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:8px;font-size:.9rem}.contractor-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.contractor-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.9rem}.btn-claim[_ngcontent-%COMP%], .btn-show-dates[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;transition:background-color .3s ease}.btn-claim[_ngcontent-%COMP%]:hover, .btn-show-dates[_ngcontent-%COMP%]:hover{background-color:#0056b3}.claimed-status[_ngcontent-%COMP%]{color:green;font-weight:700;margin-top:10px;display:block}.modal[_ngcontent-%COMP%]{display:block;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#00000080;padding-top:60px}.modal-content[_ngcontent-%COMP%]{background-color:#fff;margin:5% auto;padding:20px;border:1px solid #e0e0e0;width:80%;max-width:600px;border-radius:8px;box-shadow:0 4px 12px #0000001a}.close[_ngcontent-%COMP%]{color:#aaa;float:right;font-size:28px;font-weight:700;cursor:pointer}.close[_ngcontent-%COMP%]:hover, .close[_ngcontent-%COMP%]:focus{color:#000;text-decoration:none;cursor:pointer}.dates-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:20px}.dates-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .dates-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #e0e0e0;padding:10px;text-align:left}.dates-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f9f9f9}.total-pay[_ngcontent-%COMP%]{margin-top:20px;font-size:1rem;font-weight:700;text-align:right}"]});let o=i;return o})();function Br(o,i){if(o&1){let n=w();a(0,"div",3)(1,"button",4),g("click",function(){p(n);let t=m();return h(t.toggleComponent("client"))}),l(2,"Toggle Client"),s(),a(3,"button",4),g("click",function(){p(n);let t=m();return h(t.toggleComponent("service"))}),l(4,"Toggle Service"),s(),a(5,"button",4),g("click",function(){p(n);let t=m();return h(t.toggleComponent("job"))}),l(6,"Toggle Job"),s(),a(7,"button",4),g("click",function(){p(n);let t=m();return h(t.toggleComponent("calendar"))}),l(8,"Toggle Calendar"),s()()}}function qr(o,i){if(o&1&&V(0,"app-calendar",5),o&2){let n=m();f("jobs",n.jobs)}}function $r(o,i){if(o&1&&V(0,"app-contractor-jobs",5),o&2){let n=m();f("jobs",n.jobs)}}function Gr(o,i){o&1&&V(0,"app-client")}function Hr(o,i){o&1&&V(0,"app-service")}function zr(o,i){o&1&&V(0,"app-job")}var en=(()=>{let i=class i{constructor(e,t,r){this.jobService=e,this.authService=t,this.notificationService=r,this.jobs=[],this.showClient=!1,this.showService=!1,this.showJob=!1,this.showCalendar=!1,this.userRole=null,this.authService.loginStatus$.subscribe(()=>{this.updateUserState()})}ngOnInit(){this.updateUserState(),this.notificationService.jobUpdated$.subscribe(()=>{this.getJobs()})}getJobs(){this.jobService.getJobs().subscribe(e=>this.jobs=e)}toggleComponent(e){this.showClient=e==="client"?!this.showClient:!1,this.showService=e==="service"?!this.showService:!1,this.showJob=e==="job"?!this.showJob:!1,e==="calendar"?(this.showCalendar=!this.showCalendar,this.showCalendar&&this.getJobs()):this.showCalendar=!1}updateUserState(){this.getJobs(),this.userRole=this.authService.getUserRole()}};i.\u0275fac=function(t){return new(t||i)(_(ve),_(te),_(Z))},i.\u0275cmp=O({type:i,selectors:[["app-dashboard"]],standalone:!0,features:[F],decls:6,vars:6,consts:[["class","button-group",4,"ngIf"],[3,"jobs",4,"ngIf"],[4,"ngIf"],[1,"button-group"],[3,"click"],[3,"jobs"]],template:function(t,r){t&1&&v(0,Br,9,0,"div",0)(1,qr,1,1,"app-calendar",1)(2,$r,1,1,"app-contractor-jobs",1)(3,Gr,1,0,"app-client",2)(4,Hr,1,0,"app-service",2)(5,zr,1,0,"app-job",2),t&2&&(f("ngIf",r.userRole==="manager"),d(),f("ngIf",r.userRole==="contractor"||r.showCalendar),d(),f("ngIf",r.userRole==="contractor"),d(),f("ngIf",r.userRole==="manager"&&r.showClient),d(),f("ngIf",r.userRole==="manager"&&r.showService),d(),f("ngIf",r.userRole==="manager"&&r.showJob))},dependencies:[I,j,Gi,Hi,Xi,mt,Ki],styles:["h1[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.button-group[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px;margin-top:20px}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px 20px;margin:0 10px;border-radius:5px;font-size:1em;cursor:pointer;transition:background-color .3s,transform .3s}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{transform:scale(.95)}"]});let o=i;return o})();function Qr(o,i){if(o&1&&(a(0,"p",22),l(1),s()),o&2){let n=m();d(),b(n.loginError)}}function Yr(o,i){if(o&1){let n=w();a(0,"div")(1,"input",25),g("change",function(t){p(n);let r=m(2);return h(r.onServiceChange(t))}),s(),l(2),s()}if(o&2){let n=i.$implicit;d(),f("value",n._id),d(),M(" ",n.servicename," ")}}function Zr(o,i){if(o&1&&(a(0,"div",4)(1,"label",23),l(2,"Select Services:"),s(),v(3,Yr,3,2,"div",24),s()),o&2){let n=m();d(3),f("ngForOf",n.services)}}function Xr(o,i){if(o&1&&(a(0,"p",22),l(1),s()),o&2){let n=m();d(),b(n.signupError)}}var tn=(()=>{let i=class i{constructor(e,t,r,c){this.fb=e,this.authService=t,this.router=r,this.serviceService=c,this.loginError=null,this.signupError=null,this.services=[],this.selectedServices=[],this.isContractor=!1,this.loginForm=this.fb.group({email:[""],password:[""]}),this.signupForm=this.fb.group({newEmail:[""],newPassword:[""],role:[""]})}ngOnInit(){this.getServices()}getServices(){this.serviceService.getServices().subscribe(e=>this.services=e)}onLogin(){if(this.loginForm.valid){let{email:e,password:t}=this.loginForm.value;this.authService.login(e,t).subscribe(r=>{if(r){localStorage.setItem("currentUser",JSON.stringify(r));let c=r.role;(c==="contractor"||c==="manager")&&(this.authService.notifyLoginStatusChange(),this.router.navigate(["/dashboard"]))}},r=>{this.loginError="Invalid email or password"})}}onSignup(){if(this.signupForm.valid){let{newEmail:e,newPassword:t,role:r}=this.signupForm.value,c={email:e,password:t,role:r,services:this.selectedServices};this.authService.signup(c).subscribe(u=>{u&&(localStorage.setItem("currentUser",JSON.stringify(u)),this.authService.notifyLoginStatusChange(),this.router.navigate(["/dashboard"]))},u=>{this.signupError="Failed to create a new account"})}}onRoleChange(){this.isContractor=this.signupForm.get("role")?.value==="contractor"}onServiceChange(e){let t=e.target.value;e.target.checked?this.selectedServices.push(t):this.selectedServices=this.selectedServices.filter(r=>r!==t)}};i.\u0275fac=function(t){return new(t||i)(_(lt),_(te),_(pi),_(Je))},i.\u0275cmp=O({type:i,selectors:[["app-landingpage"]],standalone:!0,features:[F],decls:45,vars:7,consts:[[1,"landing-page-container"],[1,"form-wrapper"],[1,"form-section","login-form-container"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],["id","email","formControlName","email","type","email","required","",1,"form-control"],["for","password"],["id","password","formControlName","password","type","password","required","",1,"form-control"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","error-message",4,"ngIf"],[1,"form-section","signup-form-container"],["for","newEmail"],["id","newEmail","formControlName","newEmail","type","email","required","",1,"form-control"],["for","newPassword"],["id","newPassword","formControlName","newPassword","type","password","required","",1,"form-control"],["for","role"],["id","role","formControlName","role","required","",1,"form-select",3,"change"],["value","contractor"],["value","manager"],["class","form-group",4,"ngIf"],["type","submit",1,"btn","btn-secondary",3,"disabled"],[1,"error-message"],["for","services"],[4,"ngFor","ngForOf"],["type","checkbox",3,"change","value"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"h1"),l(2,"Boettcher Service and Supply"),s(),a(3,"h2"),l(4,"Contractor Job Portal"),s(),a(5,"div",1)(6,"div",2)(7,"h2"),l(8,"Login"),s(),a(9,"form",3),g("ngSubmit",function(){return r.onLogin()}),a(10,"div",4)(11,"label",5),l(12,"Email:"),s(),V(13,"input",6),s(),a(14,"div",4)(15,"label",7),l(16,"Password:"),s(),V(17,"input",8),s(),a(18,"button",9),l(19,"Login"),s()(),v(20,Qr,2,1,"p",10),s(),a(21,"div",11)(22,"h2"),l(23,"Sign Up"),s(),a(24,"form",3),g("ngSubmit",function(){return r.onSignup()}),a(25,"div",4)(26,"label",12),l(27,"Email:"),s(),V(28,"input",13),s(),a(29,"div",4)(30,"label",14),l(31,"Password:"),s(),V(32,"input",15),s(),a(33,"div",4)(34,"label",16),l(35,"Role:"),s(),a(36,"select",17),g("change",function(){return r.onRoleChange()}),a(37,"option",18),l(38,"Contractor"),s(),a(39,"option",19),l(40,"Manager"),s()()(),v(41,Zr,4,1,"div",20),a(42,"button",21),l(43,"Sign Up"),s()(),v(44,Xr,2,1,"p",10),s()()()),t&2&&(d(9),f("formGroup",r.loginForm),d(9),f("disabled",r.loginForm.invalid),d(2),f("ngIf",r.loginError),d(4),f("formGroup",r.signupForm),d(17),f("ngIf",r.isContractor),d(),f("disabled",r.signupForm.invalid),d(2),f("ngIf",r.signupError))},dependencies:[U,Y,ge,fe,q,ee,z,Q,K,ct,ze,Qe,I,k,j],styles:[".landing-page-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;background-color:#f0f2f5;padding:20px;box-sizing:border-box}.form-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;max-width:800px;background:#fff;border-radius:8px;box-shadow:0 4px 8px #0000001a;padding:20px}.form-section[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}h1[_ngcontent-%COMP%]{margin-bottom:20px;color:#333}h2[_ngcontent-%COMP%]{margin-bottom:15px;color:#333}.form-group[_ngcontent-%COMP%]{margin-bottom:15px;text-align:left}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;color:#555}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px;margin-bottom:10px}.btn[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:10px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;transition:background-color .3s}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#0056b3}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268}.error-message[_ngcontent-%COMP%]{color:red}"]});let o=i;return o})();var nn=[{path:"",component:tn},{path:"dashboard",component:en}];var Kr="@",eo=(()=>{let i=class i{constructor(e,t,r,c,u){this.doc=e,this.delegate=t,this.zone=r,this.animationType=c,this.moduleImpl=u,this._rendererFactoryPromise=null,this.scheduler=vt(Gt,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-JT74EJ2O.mjs").then(t=>t)).catch(t=>{throw new we(5300,!1)}).then(({\u0275createEngine:t,\u0275AnimationRendererFactory:r})=>{this._engine=t(this.animationType,this.doc);let c=new r(this.delegate,this._engine,this.zone);return this.delegate=c,c})}createRenderer(e,t){let r=this.delegate.createRenderer(e,t);if(r.\u0275type===0)return r;typeof r.throwOnSyntheticProps=="boolean"&&(r.throwOnSyntheticProps=!1);let c=new Rt(r);return t?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(u=>{let y=u.createRenderer(e,t);c.use(y),this.scheduler?.notify(9)}).catch(u=>{c.use(r)}),c}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};i.\u0275fac=function(t){$t()},i.\u0275prov=B({token:i,factory:i.\u0275fac});let o=i;return o})(),Rt=class{constructor(i){this.delegate=i,this.replay=[],this.\u0275type=1}use(i){if(this.delegate=i,this.replay!==null){for(let n of this.replay)n(i);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(i,n){return this.delegate.createElement(i,n)}createComment(i){return this.delegate.createComment(i)}createText(i){return this.delegate.createText(i)}get destroyNode(){return this.delegate.destroyNode}appendChild(i,n){this.delegate.appendChild(i,n)}insertBefore(i,n,e,t){this.delegate.insertBefore(i,n,e,t)}removeChild(i,n,e){this.delegate.removeChild(i,n,e)}selectRootElement(i,n){return this.delegate.selectRootElement(i,n)}parentNode(i){return this.delegate.parentNode(i)}nextSibling(i){return this.delegate.nextSibling(i)}setAttribute(i,n,e,t){this.delegate.setAttribute(i,n,e,t)}removeAttribute(i,n,e){this.delegate.removeAttribute(i,n,e)}addClass(i,n){this.delegate.addClass(i,n)}removeClass(i,n){this.delegate.removeClass(i,n)}setStyle(i,n,e,t){this.delegate.setStyle(i,n,e,t)}removeStyle(i,n,e){this.delegate.removeStyle(i,n,e)}setProperty(i,n,e){this.shouldReplay(n)&&this.replay.push(t=>t.setProperty(i,n,e)),this.delegate.setProperty(i,n,e)}setValue(i,n){this.delegate.setValue(i,n)}listen(i,n,e){return this.shouldReplay(n)&&this.replay.push(t=>t.listen(i,n,e)),this.delegate.listen(i,n,e)}shouldReplay(i){return this.replay!==null&&i.startsWith(Kr)}};function rn(o="animations"){return zt("NgAsyncAnimations"),Bt([{provide:Ht,useFactory:(i,n,e)=>new eo(i,n,e,o),deps:[ri,li,Qt]},{provide:qt,useValue:o==="noop"?"NoopAnimations":"BrowserAnimations"}])}var on={providers:[ii({eventCoalescing:!0}),hi(nn),di(),si(ai()),rn()]};var to={providers:[ui()]},sn=ni(on,to);var io=()=>ci(gi,sn),ca=io;export{ca as a};
